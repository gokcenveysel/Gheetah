@using Gheetah.Models.ProcessModel
@model IEnumerable<Gheetah.Models.ProcessModel.ProcessInfo>

<div class="table-responsive">
    <table class="table table-vcenter card-table">
        <thead>
            <tr>
                <th>Start Time</th>
                <th>Status</th>
                <th class="w-1">Actions</th>
            </tr>
        </thead>
        <tbody>
            @if (Model != null && Model.Any())
            {
                @foreach (var process in Model)
                {
                    <tr data-process-id="@process.Id">
                        <td class="text-muted">@process.StartTime.ToString("yyyy-MM-dd HH:mm:ss")</td>
                        <td>
                            <span class="badge @GetStatusBadgeClass(process.Status)">
                                @process.Status
                            </span>
                        </td>
                        <td>
                            <a href="@Url.Action("ExecutionAllTestOutput", "Scenarios", new { processId = process.Id })"
                               class="btn btn-sm btn-icon"
                               title="View details"
                               data-bs-toggle="tooltip">
                                <svg xmlns="http://www.w3.org/2000/svg" class="icon" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
                                    <path stroke="none" d="M0 0h24v24H0z" fill="none" />
                                    <path d="M10 12a2 2 0 1 0 4 0a2 2 0 0 0 -4 0" />
                                    <path d="M21 12c-2.4 4 -5.4 6 -9 6c-3.6 0 -6.6 -2 -9 -6c2.4 -4 5.4 -6 9 -6c3.6 0 6.6 2 9 6" />
                                </svg>
                            </a>
                        </td>
                    </tr>
                }
            }
            else
            {
                <tr>
                    <td colspan="3" class="text-center text-muted">No recent executions found</td>
                </tr>
            }
        </tbody>
    </table>
</div>

@functions {
    public static string GetStatusBadgeClass(ProcessStatus status)
    {
        return status switch
        {
            ProcessStatus.Running => "bg-blue-lt",
            ProcessStatus.Executed => "bg-green-lt",
            ProcessStatus.Failed => "bg-red-lt",
            ProcessStatus.Cancelled => "bg-yellow-lt",
            _ => "bg-secondary-lt"
        };
    }
}