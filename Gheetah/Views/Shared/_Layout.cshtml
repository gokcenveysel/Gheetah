@using System.Security.Claims
@using Gheetah.Models.ViewModels.Setup
@using Microsoft.AspNetCore.Mvc.TagHelpers
@inject Microsoft.AspNetCore.Http.IHttpContextAccessor HttpContextAccessor
@inject Gheetah.Interfaces.IDynamicAuthService DynamicAuthService

<!DOCTYPE html>
<html lang="en" data-bs-theme="light">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>@ViewData["Title"] - Gheetah</title>

    <!-- Tabler Core CSS -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@@tabler/core@1.1.1/dist/css/tabler.min.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/jstree/3.3.12/themes/default/style.min.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/vs.min.css">

    <style>
        /* Fluid layout adjustments */
        .page {
            display: flex;
            flex-direction: column;
            min-height: 100vh;
        }

        /* Top navbar styling */
        .navbar-top {
            height: 4rem;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
            z-index: 1030;
            background-color: #2a3042;
        }

        /* Secondary navbar styling */
        .navbar-secondary {
            height: 3.5rem;
            border-bottom: 1px solid rgba(0, 0, 0, 0.05);
            z-index: 1020;
            background-color: #fff;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.05);
        }

        /* Navbar brand styling */
        .navbar-brand-image {
            height: 2rem;
            transition: all 0.2s ease;
        }

        .navbar-brand:hover .navbar-brand-image {
            transform: scale(1.05);
        }

        /* Nav item hover effects */
        .navbar-nav .nav-link {
            position: relative;
            padding: 0.5rem 1rem;
            color: #fff;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .navbar-secondary .navbar-nav .nav-link {
            color: #495057;
        }

        .navbar-nav .nav-link:after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 50%;
            transform: translateX(-50%);
            width: 0;
            height: 2px;
            background: var(--tblr-primary);
            transition: width 0.3s ease;
        }

        .navbar-nav .nav-link:hover:after,
        .navbar-nav .nav-link.active:after {
            width: calc(100% - 2rem);
        }

        /* SVG icon styling */
        .nav-icon {
            width: 1.5rem;
            height: 1.5rem;
            stroke-width: 1;
        }

        /* Dropdown menu styling */
        .dropdown-menu {
            margin-top: 0;
            border-top: 0;
            border-top-left-radius: 0;
            border-top-right-radius: 0;
        }

        .dropdown-item {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.5rem 1rem;
        }

        /* User dropdown styling */
        .user-dropdown .dropdown-menu {
            margin-top: 0.5rem;
        }

        /* Main content area */
        .page-content {
            flex: 1;
            padding-top: 1.5rem;
            padding-bottom: 3rem;
        }

        /* Footer styling */
        .footer {
            padding: 1.5rem 0;
            background-color: #f8f9fa;
            border-top: 1px solid rgba(0, 0, 0, 0.05);
        }

        /* Loader için ek stil (eğer Tabler CSS'i yüklü değilse) */
        .global-loader {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(255, 255, 255, 0.95);
            z-index: 9999;
            display: flex;
            align-items: center;
            justify-content: center;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.3s ease;
        }

        .global-loader.active {
            opacity: 1;
            pointer-events: all;
        }

        .global-loader-content {
            text-align: center;
            max-width: 300px;
            padding: 2rem;
            background: white;
            border-radius: var(--tblr-border-radius-lg);
            box-shadow: var(--tblr-shadow-lg);
        }

        .loader-icon {
            width: 60px;
            height: 60px;
            margin-bottom: 1rem;
        }

        .global-loader-content svg {
            width: 128px;
            height: 128px;
        }

        [data-bs-theme="dark"] .global-loader {
            background: rgba(10, 10, 10, 0.95);
        }

        [data-bs-theme="dark"] .global-loader-content {
            background: var(--tblr-bg-surface);
        }

        /* Toast Overrides */
        .toast-container {
            position: fixed;
            top: 1rem;
            right: 1rem;
            z-index: 1100;
        }

        .toast {
            border: none;
            box-shadow: var(--tblr-shadow-lg);
        }

        .toast-info {
            background: var(--tblr-info);
            color: white;
        }

        .toast-success {
            background: var(--tblr-success);
            color: white;
        }

        .toast-danger {
            background: var(--tblr-danger);
            color: white;
        }

        .toast-warning {
            background: var(--tblr-warning);
            color: var(--tblr-dark);
        }
    </style>
    @await RenderSectionAsync("Styles", required: false)
</head>
<body>
    <div class="page">
        <!-- Top Navbar - Minimal Version -->
        <header class="navbar navbar-expand-md navbar-dark navbar-top">
            <div class="container-fluid">
                <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar-top-menu">
                    <svg xmlns="http://www.w3.org/2000/svg" class="nav-icon" width="24" height="24" viewBox="0 0 24 24" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
                        <path stroke="none" d="M0 0h24v24H0z" fill="none" />
                        <path d="M4 6l16 0" />
                        <path d="M4 12l16 0" />
                        <path d="M4 18l16 0" />
                    </svg>
                </button>

                <a class="navbar-brand" href="/">
                    <img src="/img/gheetah_icon.png" alt="Gheetah" class="navbar-brand-image me-2">
                    <span class="fw-bold">Gheetah</span>
                </a>
                
                <div class="navbar-nav">
                    <a class="nav-link" href="/Dashboard/Guide">
                        <svg xmlns="http://www.w3.org/2000/svg" class="nav-icon" width="24" height="24" viewBox="0 0 24 24" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
                            <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
                            <path d="M3 19a9 9 0 0 1 9 0a9 9 0 0 1 9 0" />
                            <path d="M3 6a9 9 0 0 1 9 0a9 9 0 0 1 9 0" />
                            <path d="M3 6l0 13" />
                            <path d="M12 6l0 13" />
                            <path d="M21 6l0 13" />
                        </svg>
                        Guide
                    </a>
                </div>

                <div class="navbar-nav flex-row order-md-last">
                    @if (User.Identity?.IsAuthenticated == true)
                    {
                        <div class="nav-item dropdown user-dropdown">
                            <a href="#" class="nav-link d-flex lh-1 text-reset p-0" data-bs-toggle="dropdown">
                                <span class="avatar avatar-sm" style="background-image: url(https://ui-avatars.com/api/?name=@User.Identity.Name&background=random)"></span>
                                <div class="d-xl-block ps-2">
                                    <div>@User.Identity.Name</div>
                                    <div class="mt-1 small text-muted">@User.Claims.LastOrDefault(c => c.Type == ClaimTypes.Role)?.Value</div>
                                </div>
                            </a>
                            <div class="dropdown-menu dropdown-menu-end dropdown-menu-arrow">
                                @{
                                    var userType = User.Claims.FirstOrDefault(c => c.Type == "UserType")?.Value;
                                    var isSSOUser = userType == "AzureSSO" || userType == "GoogleSSO";
                                }


                                @if (!isSSOUser)
                                {
                                    <a asp-controller="Account" asp-action="Profile" class="dropdown-item">
                                        <svg xmlns="http://www.w3.org/2000/svg" class="icon" width="24" height="24" viewBox="0 0 24 24" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
                                            <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
                                            <path d="M12 12m-9 0a9 9 0 1 0 18 0a9 9 0 1 0 -18 0"/>
                                            <path d="M12 10m-3 0a3 3 0 1 0 6 0a3 3 0 1 0 -6 0"/>
                                            <path d="M6.168 18.849a4 4 0 0 1 3.832 -2.849h4a4 4 0 0 1 3.834 2.855"/>
                                        </svg>
                                        Profile
                                    </a>
                                }
                                <div class="dropdown-divider"></div>
                                <a asp-controller="Account" asp-action="Logout" class="dropdown-item">
                                    <svg xmlns="http://www.w3.org/2000/svg" class="nav-icon" width="24" height="24" viewBox="0 0 24 24" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
                                        <path stroke="none" d="M0 0h24v24H0z" fill="none" />
                                        <path d="M14 8v-2a2 2 0 0 0 -2 -2h-7a2 2 0 0 0 -2 2v12a2 2 0 0 0 2 2h7a2 2 0 0 0 2 -2v-2" />
                                        <path d="M9 12h12l-3 -3" />
                                        <path d="M18 15l3 -3" />
                                    </svg>
                                    Logout
                                </a>
                            </div>
                        </div>
                    }
                    else
                    {
                        var provider = await DynamicAuthService.GetConfiguredProviderAsync();
                        if (provider == AuthProviderType.Custom)
                        {
                            <a class="btn btn-primary" href="/Account/Login">
                                <svg xmlns="http://www.w3.org/2000/svg" class="nav-icon" width="24" height="24" viewBox="0 0 24 24" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
                                    <path stroke="none" d="M0 0h24v24H0z" fill="none" />
                                    <path d="M14 8v-2a2 2 0 0 0 -2 -2h-7a2 2 0 0 0 -2 2v12a2 2 0 0 0 2 2h7a2 2 0 0 0 2 -2v-2" />
                                    <path d="M20 12h-13l3 -3m0 6l-3 -3" />
                                </svg>
                                Login
                            </a>
                        }
                    }
                </div>
            </div>
        </header>

        <!-- Secondary Navbar - Main Application Menu -->
        <nav class="navbar navbar-expand-md navbar-light navbar-secondary">
            <div class="container-fluid">
                @{
                    var user = Context.User;
                    var isAuthenticated = user.Identity?.IsAuthenticated ?? false;
                    var roles = user.Claims.Where(c => c.Type == ClaimTypes.Role).Select(c => c.Value).ToList();
                    bool hasAdminPerm = roles.Contains("Admin");
                    bool hasLeadPerm = roles.Contains("Lead");
                }

                @if (isAuthenticated)
                {
                    <div class="collapse navbar-collapse" id="navbar-secondary-menu">
                        <ul class="navbar-nav">
                            <li class="nav-item @(Context.Request.Path.StartsWithSegments("/Dashboard") ? "active" : "")">
                                <a class="nav-link" asp-controller="Dashboard" asp-action="Index">
                                    <svg xmlns="http://www.w3.org/2000/svg" class="nav-icon" width="24" height="24" viewBox="0 0 24 24" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
                                        <path stroke="none" d="M0 0h24v24H0z" fill="none" />
                                        <path d="M5 12l-2 0l9 -9l9 9l-2 0" />
                                        <path d="M5 12v7a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-7" />
                                        <path d="M9 21v-6a2 2 0 0 1 2 -2h2a2 2 0 0 1 2 2v6" />
                                    </svg>
                                    Dashboard
                                </a>
                            </li>

                            <li class="nav-item dropdown @(Context.Request.Path.StartsWithSegments("/Projects") ? "active" : "")">
                                <a class="nav-link dropdown-toggle" href="#" data-bs-toggle="dropdown">
                                    <svg xmlns="http://www.w3.org/2000/svg" class="nav-icon" width="24" height="24" viewBox="0 0 24 24" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
                                        <path stroke="none" d="M0 0h24v24H0z" fill="none" />
                                        <path d="M3 7m0 2a2 2 0 0 1 2 -2h14a2 2 0 0 1 2 2v9a2 2 0 0 1 -2 2h-14a2 2 0 0 1 -2 -2z" />
                                        <path d="M8 7v-2a2 2 0 0 1 2 -2h4a2 2 0 0 1 2 2v2" />
                                        <path d="M12 12l0 .01" />
                                        <path d="M3 13a20 20 0 0 0 18 0" />
                                    </svg>
                                    Projects
                                </a>
                                <div class="dropdown-menu">
                                    <a class="dropdown-item @(Context.Request.Path.StartsWithSegments("/Projects/ProjectList") ? "active" : "")" href="/Projects/ProjectList">
                                        <svg xmlns="http://www.w3.org/2000/svg" class="nav-icon" width="24" height="24" viewBox="0 0 24 24" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
                                            <path stroke="none" d="M0 0h24v24H0z" fill="none" />
                                            <path d="M9 5l-7 7l7 7" />
                                            <path d="M22 12l-7 -7" />
                                            <path d="M2 12l7 -7" />
                                        </svg>
                                        Project List
                                    </a>
                                    <a class="dropdown-item @(Context.Request.Path.StartsWithSegments("/Projects/ManageProjects") ? "active" : "")" href="/Projects/ManageProjects">
                                        <svg xmlns="http://www.w3.org/2000/svg" class="nav-icon" width="24" height="24" viewBox="0 0 24 24" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
                                            <path stroke="none" d="M0 0h24v24H0z" fill="none" />
                                            <path d="M12 5l0 14" />
                                            <path d="M5 12l14 0" />
                                        </svg>
                                        Add Project
                                    </a>
                                </div>
                            </li>
                            <li class="nav-item dropdown">
                                <a class="nav-link dropdown-toggle" href="#" data-bs-toggle="dropdown">
                                    <svg xmlns="http://www.w3.org/2000/svg" class="icon" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none">
                                        <path stroke="none" d="M0 0h24v24H0z" fill="none" />
                                        <path d="M4 4h6v6h-6z" />
                                        <path d="M14 4h6v6h-6z" />
                                        <path d="M4 14h6v6h-6z" />
                                        <path d="M14 14h6v6h-6z" />
                                    </svg>
                                    Agents
                                </a>
                                <div class="dropdown-menu">
                                    <a class="dropdown-item" href="/Agents/PendingRequests">Pending Agents Request</a>
                                    <a class="dropdown-item" href="/Agents/List">Agents List</a>
                                </div>
                            </li>
                            @if (hasAdminPerm || hasLeadPerm)
                            {
                                <li class="nav-item @(Context.Request.Path.StartsWithSegments("/Admin/ManageUsers") ? "active" : "")">
                                    <a class="nav-link" asp-controller="Admin" asp-action="ManageUsers">
                                        <svg xmlns="http://www.w3.org/2000/svg" class="nav-icon" width="24" height="24" viewBox="0 0 24 24" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
                                            <path stroke="none" d="M0 0h24v24H0z" fill="none" />
                                            <path d="M9 7m-4 0a4 4 0 1 0 8 0a4 4 0 1 0 -8 0" />
                                            <path d="M3 21v-2a4 4 0 0 1 4 -4h4a4 4 0 0 1 4 4v2" />
                                            <path d="M16 3.13a4 4 0 0 1 0 7.75" />
                                            <path d="M21 21v-2a4 4 0 0 0 -3 -3.85" />
                                        </svg>
                                        Users
                                    </a>
                                </li>
                            }

                            @if (hasAdminPerm)
                            {
                                <li class="nav-item dropdown @(Context.Request.Path.StartsWithSegments("/Admin/ManageGroups") || Context.Request.Path.StartsWithSegments("/Admin/ManagePermissions") || Context.Request.Path.StartsWithSegments("/SiteSettings") || Context.Request.Path.StartsWithSegments("/Logs") ? "active" : "")">
                                    <a class="nav-link dropdown-toggle" href="#" data-bs-toggle="dropdown">
                                        <svg xmlns="http://www.w3.org/2000/svg" class="nav-icon" width="24" height="24" viewBox="0 0 24 24" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
                                            <path stroke="none" d="M0 0h24v24H0z" fill="none" />
                                            <path d="M10.325 4.317c.426 -1.756 2.924 -1.756 3.35 0a1.724 1.724 0 0 0 2.573 1.066c1.543 -.94 3.31 .826 2.37 2.37a1.724 1.724 0 0 0 1.065 2.572c1.756 .426 1.756 2.924 0 3.35a1.724 1.724 0 0 0 -1.066 2.573c.94 1.543 -.826 3.31 -2.37 2.37a1.724 1.724 0 0 0 -2.572 1.065c-.426 1.756 -2.924 1.756 -3.35 0a1.724 1.724 0 0 0 -2.573 -1.066c-1.543 .94 -3.31 -.826 -2.37 -2.37a1.724 1.724 0 0 0 -1.065 -2.572c-1.756 -.426 -1.756 -2.924 0 -3.35a1.724 1.724 0 0 0 1.066 -2.573c-.94 -1.543 .826 -3.31 2.37 -2.37c1 .608 2.296 .07 2.572 -1.065z" />
                                            <path d="M9 12a3 3 0 1 0 6 0a3 3 0 0 0 -6 0" />
                                        </svg>
                                        Admin
                                    </a>
                                    <div class="dropdown-menu">
                                        <a class="dropdown-item @(Context.Request.Path.StartsWithSegments("/Admin/ManageGroups") ? "active" : "")" asp-controller="Admin" asp-action="ManageGroups">
                                            <svg xmlns="http://www.w3.org/2000/svg" class="nav-icon" width="24" height="24" viewBox="0 0 24 24" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
                                                <path stroke="none" d="M0 0h24v24H0z" fill="none" />
                                                <path d="M12 3a12 12 0 0 0 8.5 3a12 12 0 0 1 -8.5 15a12 12 0 0 1 -8.5 -15a12 12 0 0 0 8.5 -3" />
                                                <path d="M12 3l0 18" />
                                            </svg>
                                            Groups
                                        </a>
                                        <a class="dropdown-item @(Context.Request.Path.StartsWithSegments("/Admin/ManagePermissions") ? "active" : "")" asp-controller="Admin" asp-action="ManagePermissions">
                                            <svg xmlns="http://www.w3.org/2000/svg" class="nav-icon" width="24" height="24" viewBox="0 0 24 24" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
                                                <path stroke="none" d="M0 0h24v24H0z" fill="none" />
                                                <path d="M5 13a2 2 0 0 1 2 -2h10a2 2 0 0 1 2 2v6a2 2 0 0 1 -2 2h-10a2 2 0 0 1 -2 -2v-6z" />
                                                <path d="M11 16a1 1 0 1 0 2 0a1 1 0 0 0 -2 0" />
                                                <path d="M8 11v-4a4 4 0 1 1 8 0v4" />
                                            </svg>
                                            Permissions
                                        </a>
                                        <div class="dropdown-divider"></div>
                                        <a class="dropdown-item @(Context.Request.Path.StartsWithSegments("/SiteSettings") ? "active" : "")" asp-controller="SiteSettings" asp-action="Index">
                                            <svg xmlns="http://www.w3.org/2000/svg" class="nav-icon" width="24" height="24" viewBox="0 0 24 24" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
                                                <path stroke="none" d="M0 0h24v24H0z" fill="none" />
                                                <path d="M10.325 4.317c.426 -1.756 2.924 -1.756 3.35 0a1.724 1.724 0 0 0 2.573 1.066c1.543 -.94 3.31 .826 2.37 2.37a1.724 1.724 0 0 0 1.065 2.572c1.756 .426 1.756 2.924 0 3.35a1.724 1.724 0 0 0 -1.066 2.573c.94 1.543 -.826 3.31 -2.37 2.37a1.724 1.724 0 0 0 -2.572 1.065c-.426 1.756 -2.924 1.756 -3.35 0a1.724 1.724 0 0 0 -2.573 -1.066c-1.543 .94 -3.31 -.826 -2.37 -2.37a1.724 1.724 0 0 0 -1.065 -2.572c-1.756 -.426 -1.756 -2.924 0 -3.35a1.724 1.724 0 0 0 1.066 -2.573c-.94 -1.543 .826 -3.31 2.37 -2.37c1 .608 2.296 .07 2.572 -1.065z" />
                                                <path d="M9 12a3 3 0 1 0 6 0a3 3 0 0 0 -6 0" />
                                            </svg>
                                            Site Settings
                                        </a>
                                        <a class="dropdown-item @(Context.Request.Path.StartsWithSegments("/Logs") ? "active" : "")" asp-controller="Projects" asp-action="Index">
                                            <svg class="nav-icon" width="24" height="24" viewBox="0 0 512 512" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
                                                <title>log</title>
                                                <g id="Page-1" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">
                                                    <g id="log-white" fill="#000000" transform="translate(85.572501, 42.666667)">
                                                        <path d="M236.349632,7.10542736e-15 L1.68296533,7.10542736e-15 L1.68296533,234.666667 L44.349632,234.666667 L44.349632,192 L44.349632,169.6 L44.349632,42.6666667 L218.642965,42.6666667 L300.349632,124.373333 L300.349632,169.6 L300.349632,192 L300.349632,234.666667 L343.016299,234.666667 L343.016299,106.666667 L236.349632,7.10542736e-15 L236.349632,7.10542736e-15 Z M4.26325641e-14,405.333333 L4.26325641e-14,277.360521 L28.8096875,277.360521 L28.8096875,382.755208 L83.81,382.755208 L83.81,405.333333 L4.26325641e-14,405.333333 Z M153.17,275.102708 C173.279583,275.102708 188.692917,281.484792 199.41,294.248958 C209.705625,306.47125 214.853437,322.185625 214.853437,341.392083 C214.853437,362.404792 208.772396,379.112604 196.610312,391.515521 C186.134062,402.232604 171.653958,407.591146 153.17,407.591146 C133.060417,407.591146 117.647083,401.209062 106.93,388.444896 C96.634375,376.222604 91.4865625,360.267396 91.4865625,340.579271 C91.4865625,319.988021 97.5676042,303.490937 109.729687,291.088021 C120.266146,280.431146 134.74625,275.102708 153.17,275.102708 Z M153.079687,297.680833 C142.663646,297.680833 134.625833,302.015833 128.96625,310.685833 C123.848542,318.512917 121.289687,328.567708 121.289687,340.850208 C121.289687,355.059375 124.330208,366.0775 130.41125,373.904583 C136.131042,381.310208 143.717292,385.013021 153.17,385.013021 C163.525833,385.013021 171.59375,380.647917 177.37375,371.917708 C182.491458,364.211042 185.050312,354.035833 185.050312,341.392083 C185.050312,327.483958 182.009792,316.616354 175.92875,308.789271 C170.208958,301.383646 162.592604,297.680833 153.079687,297.680833 Z M343.91,333.715521 L343.91,399.011458 C336.564583,401.48 331.386667,403.105625 328.37625,403.888333 C319.043958,406.356875 309.019271,407.591146 298.302187,407.591146 C277.229271,407.591146 261.18375,402.292812 250.165625,391.696146 C237.943333,380.015729 231.832187,363.729375 231.832187,342.837083 C231.832187,318.813958 239.418437,300.69125 254.590937,288.468958 C265.609062,279.558125 280.480521,275.102708 299.205312,275.102708 C315.220729,275.102708 330.122292,278.022812 343.91,283.863021 L334.065937,306.350833 C327.563437,303.099583 321.87375,300.826719 316.996875,299.53224 C312.12,298.23776 306.761458,297.590521 300.92125,297.590521 C286.952917,297.590521 276.657292,302.13625 270.034375,311.227708 C264.435,318.934375 261.635312,329.079479 261.635312,341.663021 C261.635312,356.775312 265.849896,368.154687 274.279062,375.801146 C281.022396,381.942396 289.391354,385.013021 299.385937,385.013021 C305.226146,385.013021 310.765312,384.019583 316.003437,382.032708 L316.003437,356.293646 L293.967187,356.293646 L293.967187,333.715521 L343.91,333.715521 Z" id="XLS">

                                                        </path>
                                                    </g>
                                                </g>
                                            </svg>
                                            Logs
                                        </a>
                                    </div>
                                </li>
                            }
                        </ul>
                    </div>
                }
            </div>
        </nav>

        <!-- Main Content -->
        <div class="page-wrapper">
            <div class="container-fluid page-content" style="padding-top:unset !important">
                @RenderBody()
            </div>
        </div>
        <div id="globalLoader" class="global-loader">
            <div class="global-loader-content">
                <svg xmlns="http://www.w3.org/2000/svg" xml:space="preserve" viewBox="0 0 64 64"><g><path fill="#1f6dbd" d="M8.944 3.374c-1.08.172-2.047.516-2.957 1.146-5.232 3.555-1.99 10.608.284 14.966.626 1.147 1.65 2.236 1.99 3.498.455 1.433-.17 3.383-.284 4.816-.114 2.065.17 4.358.569 6.365 1.592 8.601 7.165 16.915 14.16 22.019 2.673 1.892 6.086 4.07 9.555 3.612 4.379-.573 8.132-3.383 11.203-6.422 5.573-5.447 9.782-12.213 11.147-20.012.398-2.408.17-5.103.17-7.569-.057-.802-.284-1.72-.114-2.522.285-1.262 1.308-2.466 1.934-3.556 1.934-3.497 5.061-9.92 2.104-13.646-3.07-3.842-8.246-3.154-11.942-.746-1.252.803-2.389 2.466-3.754 2.924-.91.287-2.161-.344-3.014-.573-1.877-.459-3.81-.63-5.744-.803-3.07-.344-6.483-.114-9.497.402-1.308.229-3.242 1.204-4.55 1.032-1.194-.23-2.275-1.778-3.241-2.466-2.218-1.663-5.176-2.924-8.019-2.465z" vector-effect="non-scaling-stroke" /><path fill="#fefefe" d="M10.48 5.558c1.934 1.95 4.038 3.383 5.573 5.792.398.688 1.365 3.44-.512 2.695-.91-.344-1.478-1.663-1.99-2.409-1.422-1.892-3.754-4.53-6.313-4.53-1.876 0-1.82 2.122-1.763 3.498.057 3.211 2.048 6.766 3.754 9.347.625-.746 2.218-4.76 3.583-3.154.796.917-.512 2.35-.91 3.154-1.138 2.465-1.65 5.447-1.706 8.142-.057 6.766 2.388 13.303 6.369 18.693 1.365 1.835 2.844 3.784 4.663 5.103-.796-2.408-1.421-4.874-1.763-7.34-.17-1.032-.455-2.293-.056-3.268.454-1.204 1.82-1.835 2.616-2.867 1.364-1.835 2.104-4.931 1.933-7.282-.114-1.663-2.332-1.376-3.469-2.007-1.706-.975-2.502-2.466-2.787-4.358-.91 0-3.526-.86-1.706-2.007.626-.401 1.536-.23 2.218-.23 1.877 0 5.858-.056 7.109 1.55.796.974.626 2.58.682 3.726.228 3.498.455 7.168-1.25 10.379-.74 1.376-2.901 2.81-3.185 4.358-.285 1.433.398 3.325.739 4.759.455 2.236 1.08 5.39 2.445 7.282 1.195 1.72 4.664 3.096 6.711 3.096 2.104 0 5.516-1.376 6.767-3.096 1.365-1.892 1.99-5.046 2.446-7.282.341-1.434 1.024-3.326.74-4.76-.285-1.433-2.332-2.81-3.015-4.07-1.877-3.269-1.706-7.053-1.422-10.666.057-1.147-.057-2.752.683-3.727 1.308-1.72 5.175-1.548 7.109-1.548.682 0 1.592-.172 2.217.23 1.82 1.146-.796 2.006-1.763 2.006-.284 3.44-3.07 5.046-6.255 5.103 0 2.58.17 5.505 1.535 7.799.796 1.376 2.73 2.35 3.128 3.841.284.975.057 2.065-.114 3.04-.34 2.35-1.194 4.644-1.535 7.052 1.763-1.261 3.07-3.096 4.379-4.816 3.98-5.333 6.37-11.698 6.37-18.464 0-2.752-.512-5.848-1.65-8.371-.398-.746-1.706-2.294-.91-3.154.455-.459 1.138-.172 1.536.23.966.745 1.308 2.006 2.047 2.924 1.706-2.58 3.64-6.136 3.753-9.347.057-2.121-.455-4.128-3.014-3.268-2.16.745-3.924 2.695-5.232 4.53-.512.688-1.194 2.35-2.275 2.236-1.478-.172-.511-2.064-.056-2.752a17.87 17.87 0 0 1 5.573-5.562c-2.161-.746-5.517 1.892-6.938 3.325-.569.574-1.08 1.377-1.82 1.72-.796.345-1.536-.114-2.275-.343-1.08-.46-2.275-.746-3.469-.918.74 2.867 2.104 5.62 2.218 8.601.057.86-.114 3.612-1.592 2.408-.91-.688-.626-2.408-.853-3.383-.455-2.007-.854-3.956-1.65-5.848-.284-.688-.568-1.606-1.194-2.007-.91-.516-2.445-.23-3.469-.23-.91 0-2.047-.172-2.957.058-.967.286-1.308 1.319-1.65 2.179-.91 2.121-1.592 4.53-1.82 6.823-.113.803-.113 3.096-1.535 2.523-1.024-.459-.796-2.122-.74-2.982.285-2.81 1.48-5.447 2.219-8.142-1.08.172-2.218.459-3.242.803-.682.23-1.478.745-2.275.573-1.08-.344-1.933-1.72-2.73-2.408-1.762-1.548-3.923-2.81-6.255-2.982z" vector-effect="non-scaling-stroke" /><path fill="#fefefe" d="M20.004 25.094c.683 1.777 1.877 2.465 3.754 2.523-.285-2.351-1.593-2.523-3.754-2.523zM39.54 25.323l-.228 2.294c1.82-.058 3.07-.803 3.753-2.523z" vector-effect="non-scaling-stroke" /><path fill="#1f6dbd" d="M27.062 41.754c-1.024.458-.626 1.72-.341 2.58a7.242 7.242 0 0 0 1.82 3.039c.853.86 2.047 1.376 1.933 2.81-.057 2.236-3.128.974-3.526 2.752-.113.745.455 1.147 1.08 1.204 1.195.115 2.332-.63 3.47-.63 1.251 0 2.73 1.089 3.98.515.854-.401.74-1.318 0-1.777-1.194-.803-3.355-.459-2.9-2.58.285-1.033 1.252-1.606 1.934-2.294 1.08-1.147 2.047-2.695 2.104-4.3q.057-1.205-1.08-1.434c-1.82-.401-3.924-.057-5.744-.057-.853 0-1.934-.23-2.73.172z" vector-effect="non-scaling-stroke" /><path fill="#fefefe" d="M29.004 43.838c1.08 3.153 3.981 3.153 5.005 0z" vector-effect="non-scaling-stroke" /></g></svg>
        
                <!-- Progress Bar -->
                <div class="progress progress-sm mt-3 w-100">
                    <div class="progress-bar progress-bar-indeterminate"></div>
                </div>
                <h4 class="loader-message mt-2 text-muted" id="loaderMessage">Processing your request...</h4>
            </div>
        </div>

        <!-- Footer -->
        <footer class="footer">
            <div class="container-fluid">
                <div class="row align-items-center flex-row-reverse">
                    <div class="col-auto ms-auto">
                        <ul class="list-inline list-inline-dots mb-0">
                            <li class="list-inline-item"><a href="#" class="link-secondary">Documentation</a></li>
                            <li class="list-inline-item"><a href="#" class="link-secondary">Support</a></li>
                        </ul>
                    </div>
                    <div class="col-auto">
                        © @DateTime.Now.Year Gheetah. All rights reserved.
                    </div>
                </div>
            </div>
        </footer>
    </div>

    <!-- Tabler Core JS -->
    <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@@tabler/core@1.1.1/dist/js/tabler.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jstree/3.3.12/jstree.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/languages/gherkin.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/microsoft-signalr/5.0.11/signalr.min.js"></script>
    <script src="~/js/loader.js"></script>
    <script src="~/js/toast-utils.js"></script>
    <script>
    // Smooth dropdown behavior
    document.addEventListener("DOMContentLoaded", function() {
        // Dropdown hover effect
        $('.dropdown-toggle').on('mouseenter', function() {
            $(this).parent().addClass('hover');
        }).on('mouseleave', function() {
            $(this).parent().removeClass('hover');
        });

        // Active nav item highlighting
        $('.nav-item a').each(function() {
            if (this.href === window.location.href) {
                $(this).addClass('active');
                $(this).closest('.dropdown').addClass('active');
            }
        });

        // Add Projects click handler
        $('a[href="/Projects/ManageProjects"]').on('click', function(e) {
            e.preventDefault();
                    Loader.show("Repositories loading...") // Loader'ı göster
            window.location.href = $(this).attr('href'); // Sayfaya yönlendir
        });

        document.querySelectorAll('.modal').forEach(modal => {
            modal.addEventListener('hidden.bs.modal', function() {
                // Odaklanmayı body'ye al
                document.body.focus();

                // Modal tamamen kapandıktan sonra aria-hidden ayarla
                setTimeout(() => {
                    modal.setAttribute('aria-hidden', 'true');
                }, 150);
            });

            modal.addEventListener('shown.bs.modal', function() {
                // Modal gösterildiğinde aria-hidden kaldır
                modal.removeAttribute('aria-hidden');

                // Odağı modal içindeki ilk focusable öğeye al
                const focusable = modal.querySelector('button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"])');
                if (focusable) focusable.focus();
            });
        });

        // Modal kapatma butonları için özel işlem
        document.querySelectorAll('[data-bs-dismiss="modal"]').forEach(btn => {
            btn.addEventListener('click', function() {
                const modal = this.closest('.modal');
                if (modal) {
                    // Önce odağı body'ye al
                    document.body.focus();

                    // Sonra modalı kapat
                    const modalInstance = bootstrap.Modal.getInstance(modal);
                    if (modalInstance) modalInstance.hide();
                }
            });
        });
    });

    window.addEventListener('load', function() {
                Loader.hide();
    });
</script>

    @await RenderSectionAsync("Scripts", required: false)
    </body>
</html>