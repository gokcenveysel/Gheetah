@using Gheetah.Models.CICDModel
@using Microsoft.AspNetCore.Mvc.TagHelpers
@model Gheetah.Models.SiteSettingsModel.SiteSettingsVm
@{
    ViewData["Title"] = "Settings";
}

<style>
    .repo-form {
        transition: all 0.3s ease;
    }

        .repo-form input:disabled {
            background-color: var(--tblr-form-select-disabled-bg);
        }

    .form-check-card {
        display: block;
        text-align: center;
        padding: 1rem;
        border: 1px solid var(--tblr-border-color);
        border-radius: var(--tblr-border-radius);
        transition: all 0.2s;
        cursor: pointer;
    }

    .form-check-card:hover {
        border-color: var(--tblr-primary);
    }

    .form-check-card .form-check-input {
        position: absolute;
        opacity: 0;
    }

    .form-check-card-content {
        display: flex;
        flex-direction: column;
        align-items: center;
    }

    .form-check-card .form-check-input:checked ~ .form-check-card-content {
        color: var(--tblr-primary);
    }

    .form-check-card .form-check-input:checked {
        border-color: var(--tblr-primary);
    }

    .cicd-form {
        transition: all 0.3s ease;
    }
</style>

<!-- BEGIN PAGE HEADER -->
<div class="page-header d-print-none">
    <div class="container-fluid">
        <div class="row g-2 align-items-center">
            <div class="col">
                <h2 class="page-title">
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-settings" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
                        <path stroke="none" d="M0 0h24v24H0z" fill="none" />
                        <path d="M10.325 4.317c.426 -1.756 2.924 -1.756 3.35 0a1.724 1.724 0 0 0 2.573 1.066c1.543 -.94 3.31 .826 2.37 2.37a1.724 1.724 0 0 0 1.065 2.572c1.756 .426 1.756 2.924 0 3.35a1.724 1.724 0 0 0 -1.066 2.573c.94 1.543 -.826 3.31 -2.37 2.37a1.724 1.724 0 0 0 -2.572 1.065c-.426 1.756 -2.924 1.756 -3.35 0a1.724 1.724 0 0 0 -2.573 -1.066c-1.543 .94 -3.31 -.826 -2.37 -2.37a1.724 1.724 0 0 0 -1.065 -2.572c-1.756 -.426 -1.756 -2.924 0 -3.35a1.724 1.724 0 0 0 1.066 -2.573c-.94 -1.543 .826 -3.31 2.37 -2.37c1 .608 2.296 .07 2.572 -1.065z" />
                        <path d="M9 12a3 3 0 1 0 6 0a3 3 0 0 0 -6 0" />
                    </svg>
                    Settings
                </h2>
            </div>
        </div>
    </div>
</div>
<!-- END PAGE HEADER -->
<!-- BEGIN PAGE BODY -->
<div class="page-body">
    <div class="container-fluid">
        <div class="card">
            <div class="row g-0">
                <!-- Left Sidebar Menu -->
                <div class="col-12 col-md-3 border-end">
                    <div class="card-body">
                        <h4 class="subheader">Repository</h4>
                        <div class="list-group list-group-transparent">
                            <a href="#" class="list-group-item list-group-item-action d-flex align-items-center active" id="remote-repo-tab">
                                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-cloud me-2" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
                                    <path stroke="none" d="M0 0h24v24H0z" fill="none" />
                                    <path d="M6.657 18c-2.572 0 -4.657 -2.007 -4.657 -4.483c0 -2.475 2.085 -4.482 4.657 -4.482c.393 -1.762 1.794 -3.2 3.675 -3.773c1.88 -.572 3.956 -.193 5.444 1c1.488 1.19 2.162 3.007 1.77 4.769h.99c1.913 0 3.464 1.56 3.464 3.486c0 1.927 -1.551 3.487 -3.465 3.487h-11.878" />
                                </svg>
                                Remote Repositories
                            </a>
                            <a href="#" class="list-group-item list-group-item-action d-flex align-items-center" id="project-dir-tab">
                                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-folder me-2" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
                                    <path stroke="none" d="M0 0h24v24H0z" fill="none" />
                                    <path d="M5 4h4l3 3h7a2 2 0 0 1 2 2v8a2 2 0 0 1 -2 2h-14a2 2 0 0 1 -2 -2v-11a2 2 0 0 1 2 -2" />
                                </svg>
                                Project Directory
                            </a>
                            <a href="#" class="list-group-item list-group-item-action d-flex align-items-center" id="cicd-settings-tab">
                                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-settings-automation me-2" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
                                    <path stroke="none" d="M0 0h24v24H0z" fill="none" />
                                    <path d="M9 12a3 3 0 1 0 6 0a3 3 0 0 0 -6 0z" />
                                    <path d="M15.9 6.1l2.1 -2.1" />
                                    <path d="M20 12h2" />
                                    <path d="M15.9 17.9l2.1 2.1" />
                                    <path d="M9 21v2" />
                                    <path d="M4.1 17.9l-2.1 2.1" />
                                    <path d="M2 12h-2" />
                                    <path d="M4.1 6.1l-2.1 -2.1" />
                                    <path d="M9 3v-2" />
                                </svg>
                                CI/CD Settings
                            </a>
                            <a href="#" class="list-group-item list-group-item-action d-flex align-items-center" id="mail-settings-tab">
                                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-mail me-2" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
                                    <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
                                    <path d="M3 7a2 2 0 0 1 2 -2h14a2 2 0 0 1 2 2v10a2 2 0 0 1 -2 2h-14a2 2 0 0 1 -2 -2v-10z"></path>
                                    <path d="M3 7l9 6l9 -6"></path>
                                </svg>
                                Mail Settings
                            </a>
                        </div>
                    </div>
                </div>

                <!-- Right Content Area -->
                <div class="col-12 col-md-9 d-flex flex-column">
                    <!-- Remote Repositories Content -->
                    <div class="card-body" id="remote-repo-content">
                        <div class="d-flex justify-content-between align-items-center mb-4">
                            <h2 class="mb-0">Remote Repositories</h2>
                            <button class="btn btn-sm btn-primary" data-bs-toggle="modal" data-bs-target="#add-repo-modal">
                                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-plus" width="20" height="20" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
                                    <path stroke="none" d="M0 0h24v24H0z" fill="none" />
                                    <path d="M12 5l0 14" />
                                    <path d="M5 12l14 0" />
                                </svg>
                                Add Repository
                            </button>
                        </div>

                        @if (Model == null || !Model.RepoSettingsList.Any())
                        {
                            <div class="empty">
                                <div class="empty-icon">
                                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-cloud-off" width="48" height="48" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
                                        <path stroke="none" d="M0 0h24v24H0z" fill="none" />
                                        <path d="M9.58 5.548c.24 -.11 .492 -.207 .752 -.286c1.88 -.572 3.956 -.193 5.444 1c1.488 1.19 2.162 3.007 1.77 4.769h.99c1.913 0 3.464 1.56 3.464 3.486c0 .957 -.383 1.824 -1.003 2.454m-2.997 1.033h-11.878c-2.572 0 -4.657 -2.007 -4.657 -4.483c0 -2.475 2.085 -4.482 4.657 -4.482c.13 -.582 .37 -1.128 .7 -1.62" />
                                        <path d="M3 3l18 18" />
                                    </svg>
                                </div>
                                <p class="empty-title">No repositories configured</p>
                                <p class="empty-subtitle text-muted">
                                    Connect your first remote repository to get started
                                </p>
                                <div class="empty-action">
                                    <button class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#add-repo-modal">
                                        <svg xmlns="http://www.w3.org/2000/svg" class="icon" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
                                            <path stroke="none" d="M0 0h24v24H0z" fill="none" />
                                            <path d="M12 5l0 14" />
                                            <path d="M5 12l14 0" />
                                        </svg>
                                        Add Repository
                                    </button>
                                </div>
                            </div>
                        }
                        else
                        {
                            <div class="table-responsive">
                                <table class="table table-vcenter table-nowrap">
                                    <thead>
                                        <tr>
                                            <th>Repository</th>
                                            <th>Type</th>
                                            <th>Status</th>
                                            <th>Last Sync</th>
                                            <th class="w-1">Actions</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        @foreach (var repo in Model.RepoSettingsList)
                                        {
                                            <tr data-repo-id="@repo.Id">
                                                <td>
                                                    <div class="d-flex align-items-center">
                                                        @if (repo.RepoType == "GitHub")
                                                        {
                                                            <span class="avatar avatar-sm me-3" style="background-image: url(https://github.githubassets.com/images/modules/logos_page/GitHub-Mark.png)"></span>
                                                        }
                                                        else if (repo.RepoType == "Bitbucket")
                                                        {
                                                            <span class="avatar avatar-sm me-3" style="background-image: url(https://git-scm.com/images/logos/downloads/Git-Icon-1788C.png)"></span>
                                                        }
                                                        else if (repo.RepoType == "GitLab")
                                                        {
                                                            <span class="avatar avatar-sm me-3" style="background-image: url(https://about.gitlab.com/images/press/logo/png/gitlab-icon-rgb.png)"></span>
                                                        }
                                                        else if (repo.RepoType == "Azure")
                                                        {
                                                            <span class="avatar avatar-sm me-3" style="background-image: url(https://azure.microsoft.com/svghandler/devops/?width=600&height=315)"></span>
                                                        }
                                                        <div>
                                                            <div class="font-weight-medium">@repo.DisplayName</div>
                                                            <div class="text-muted">
                                                                @if (!string.IsNullOrEmpty(repo.AccessToken))
                                                                {
                                                                    <span class="badge bg-green-lt">Token Configured</span>
                                                                }
                                                                else
                                                                {
                                                                    <span class="badge bg-red-lt">No token</span>
                                                                }
                                                            </div>
                                                        </div>
                                                    </div>
                                                </td>
                                                <td>
                                                    <span class="badge bg-@(repo.RepoType == "GitHub" ? "purple" : repo.RepoType == "Bitbucket" ? "blue" : repo.RepoType == "GitLab" ? "orange" : "azure")-lt">
                                                        @repo.RepoType
                                                    </span>
                                                </td>
                                                <td>
                                                    <span class="badge bg-green-lt">
                                                        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-circle-check" width="16" height="16" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
                                                            <path stroke="none" d="M0 0h24v24H0z" fill="none" />
                                                            <path d="M12 12m-9 0a9 9 0 1 0 18 0a9 9 0 1 0 -18 0" />
                                                            <path d="M9 12l2 2l4 -4" />
                                                        </svg>
                                                        Connected
                                                    </span>
                                                </td>
                                                <td class="text-muted">
                                                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-clock" width="16" height="16" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
                                                        <path stroke="none" d="M0 0h24v24H0z" fill="none" />
                                                        <path d="M3 12a9 9 0 1 0 18 0a9 9 0 0 0 -18 0" />
                                                        <path d="M12 7v5l3 3" />
                                                    </svg>
                                                    @DateTime.Now.AddDays(-1).ToString("g")
                                                </td>
                                                <td>
                                                    <div class="btn-list flex-nowrap">
                                                        <a href="#" class="btn btn-sm" data-bs-toggle="modal" data-bs-target="#edit-repo-modal" data-repo-id="@repo.Id">
                                                            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-edit" width="16" height="16" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
                                                                <path stroke="none" d="M0 0h24v24H0z" fill="none" />
                                                                <path d="M7 7h-1a2 2 0 0 0 -2 2v9a2 2 0 0 0 2 2h9a2 2 0 0 0 2 -2v-1" />
                                                                <path d="M20.385 6.585a2.1 2.1 0 0 0 -2.97 -2.97l-8.415 8.385v3h3l8.385 -8.415z" />
                                                                <path d="M16 5l3 3" />
                                                            </svg>
                                                            Edit
                                                        </a>
                                                        <a href="#" class="btn btn-sm btn-danger" data-bs-toggle="modal" data-bs-target="#delete-repo-modal" data-repo-id="@repo.Id">
                                                            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-trash" width="16" height="16" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
                                                                <path stroke="none" d="M0 0h24v24H0z" fill="none" />
                                                                <path d="M4 7l16 0" />
                                                                <path d="M10 11l0 6" />
                                                                <path d="M14 11l0 6" />
                                                                <path d="M5 7l1 12a2 2 0 0 0 2 2h8a2 2 0 0 0 2 -2l1 -12" />
                                                                <path d="M9 7v-3a1 1 0 0 1 1 -1h4a1 1 0 0 1 1 1v3" />
                                                            </svg>
                                                            Delete
                                                        </a>
                                                    </div>
                                                </td>
                                            </tr>
                                        }
                                    </tbody>
                                </table>
                            </div>
                        }
                    </div>

                    <!-- Project Directory Content (Hidden by default) -->
                    <div class="card-body d-none" id="project-dir-content">
                        <h2 class="mb-4">Project Directory</h2>
                        <form method="post" asp-action="SaveProjectFolder">
                            <div class="mb-3">
                                <label class="form-label required">Local Project Path</label>
                                <input type="text" class="form-control" name="folder" value="@(ViewBag.ProjectFolder ?? "")" placeholder="e.g. C:\Projects or /home/user/projects" required>
                            </div>
                            <div class="form-footer">
                                <button type="submit" class="btn btn-primary">
                                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-device-floppy" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
                                        <path stroke="none" d="M0 0h24v24H0z" fill="none" />
                                        <path d="M6 4h10l4 4v10a2 2 0 0 1 -2 2h-12a2 2 0 0 1 -2 -2v-12a2 2 0 0 1 2 -2" />
                                        <path d="M12 14m-2 0a2 2 0 1 0 4 0a2 2 0 1 0 -4 0" />
                                        <path d="M14 4l0 4l-6 0l0 -4" />
                                    </svg>
                                    Save Directory
                                </button>
                            </div>
                        </form>
                    </div>

                    <!-- CI/CD Settings Content -->
                    <div class="card-body d-none" id="cicd-settings-content">
                        <div class="d-flex justify-content-between align-items-center mb-4">
                            <h2 class="mb-0">CI/CD Settings</h2>
                            <button class="btn btn-sm btn-primary" data-bs-toggle="modal" data-bs-target="#modal-add-cicd">
                                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-plus" width="20" height="20" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
                                    <path stroke="none" d="M0 0h24v24H0z" fill="none" />
                                    <path d="M12 5l0 14" />
                                    <path d="M5 12l14 0" />
                                </svg>
                                Add CI/CD Setting
                            </button>
                        </div>

                        @if (Model.CICDSettingsList == null || !Model.CICDSettingsList.Any())
                        {
                            <div class="empty">
                                <div class="empty-icon">
                                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-cloud-off" width="48" height="48" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
                                        <path stroke="none" d="M0 0h24v24H0z" fill="none" />
                                        <path d="M9.58 5.548c.24 -.11 .492 -.207 .752 -.286c1.88 -.572 3.956 -.193 5.444 1c1.488 1.19 2.162 3.007 1.77 4.769h.99c1.913 0 3.464 1.56 3.464 3.486c0 .957 -.383 1.824 -1.003 2.454m-2.997 1.033h-11.878c-2.572 0 -4.657 -2.007 -4.657 -4.483c0 -2.475 2.085 -4.482 4.657 -4.482c.13 -.582 .37 -1.128 .7 -1.62" />
                                        <path d="M3 3l18 18" />
                                    </svg>
                                </div>
                                <p class="empty-title">No CI/CD settings configured</p>
                                <p class="empty-subtitle text-muted">
                                    Add your first CI/CD configuration to get started
                                </p>
                                <div class="empty-action">
                                    <button class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#modal-add-cicd">
                                        <svg xmlns="http://www.w3.org/2000/svg" class="icon" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
                                            <path stroke="none" d="M0 0h24v24H0z" fill="none" />
                                            <path d="M12 5l0 14" />
                                            <path d="M5 12l14 0" />
                                        </svg>
                                        Add CI/CD Setting
                                    </button>
                                </div>
                            </div>
                        }
                        else
                        {
                            <div class="table-responsive">
                                <table class="table table-vcenter table-nowrap">
                                    <thead>
                                    <tr>
                                        <th>Provider</th>
                                        <th>Project</th>
                                        <th>Create Date</th>
                                        <th>Status</th>
                                        <th class="w-1">Actions</th>
                                    </tr>
                                    </thead>
                                    <tbody>
                                    @foreach (var setting in Model.CICDSettingsList)
                                    {
                                        <tr data-setting-id="@setting.Id">
                                            <td>
                                                <div class="d-flex align-items-center">
                                                    @if (setting.ToolType == CICDToolType.GitLab)
                                                    {
                                                        <span class="avatar avatar-sm me-3" style="background-image: url(https://about.gitlab.com/images/press/logo/png/gitlab-icon-rgb.png)"></span>
                                                    }
                                                    else if (setting.ToolType == CICDToolType.Jenkins)
                                                    {
                                                        <span class="avatar avatar-sm me-3" style="background-image: url(https://www.jenkins.io/images/logos/jenkins/jenkins.png)"></span>
                                                    }
                                                    else if (setting.ToolType == CICDToolType.Azure)
                                                    {
                                                        <span class="avatar avatar-sm me-3" style="background-image: url(https://azure.microsoft.com/svghandler/devops/?width=600&height=315)"></span>
                                                    }
                                                    <div>@setting.ToolType</div>
                                                </div>
                                            </td>
                                            <td>@setting.Name</td>
                                            <td>@setting.CreatedDate</td>
                                            <td>
                                                <span class="badge bg-green-lt">
                                                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-circle-check" width="16" height="16" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
                                                        <path stroke="none" d="M0 0h24v24H0z" fill="none" />
                                                        <path d="M12 12m-9 0a9 9 0 1 0 18 0a9 9 0 1 0 -18 0" />
                                                        <path d="M9 12l2 2l4 -4" />
                                                    </svg>
                                                    Active
                                                </span>
                                            </td>
                                            <td>
                                                <div class="btn-list flex-nowrap">
                                                    <a href="#" class="btn btn-sm" data-bs-toggle="modal" data-bs-target="#edit-cicd-modal" data-setting-id="@setting.Id">
                                                        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-edit" width="16" height="16" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
                                                            <path stroke="none" d="M0 0h24v24H0z" fill="none" />
                                                            <path d="M7 7h-1a2 2 0 0 0 -2 2v9a2 2 0 0 0 2 2h9a2 2 0 0 0 2 -2v-1" />
                                                            <path d="M20.385 6.585a2.1 2.1 0 0 0 -2.97 -2.97l-8.415 8.385v3h3l8.385 -8.415z" />
                                                            <path d="M16 5l3 3" />
                                                        </svg>
                                                        Edit
                                                    </a>
                                                    <a href="#" class="btn btn-sm btn-danger" data-bs-toggle="modal" data-bs-target="#delete-cicd-modal" data-setting-id="@setting.Id">
                                                        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-trash" width="16" height="16" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
                                                            <path stroke="none" d="M0 0h24v24H0z" fill="none" />
                                                            <path d="M4 7l16 0" />
                                                            <path d="M10 11l0 6" />
                                                            <path d="M14 11l0 6" />
                                                            <path d="M5 7l1 12a2 2 0 0 0 2 2h8a2 2 0 0 0 2 -2l1 -12" />
                                                            <path d="M9 7v-3a1 1 0 0 1 1 -1h4a1 1 0 0 1 1 1v3" />
                                                        </svg>
                                                        Delete
                                                    </a>
                                                </div>
                                            </td>
                                        </tr>
                                    }
                                    </tbody>
                                </table>
                            </div>
                        }
                    </div>
                    
                    <!-- Mail Settings Content -->
                    <div class="card-body d-none" id="mail-settings-content">
                        <div class="d-flex justify-content-between align-items-center mb-4">
                            <h2 class="mb-0">Mail Settings</h2>
                            <button class="btn btn-sm btn-primary" data-bs-toggle="modal" data-bs-target="#add-mail-modal">
                                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-plus" width="20" height="20" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
                                    <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
                                    <path d="M12 5l0 14"></path>
                                    <path d="M5 12l14 0"></path>
                                </svg>
                                Add Mail Settings
                            </button>
                        </div>

                        @if (Model?.MailSettingsList == null || !Model.MailSettingsList.Any())
                        {
                            <div class="empty">
                                <div class="empty-icon">
                                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-mail-off" width="48" height="48" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
                                        <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
                                        <path d="M9 5h10a2 2 0 0 1 2 2v10m-2 2h-14a2 2 0 0 1 -2 -2v-10a2 2 0 0 1 2 -2"></path>
                                        <path d="M3 7l9 6l.565 -.377m2.435 -1.623l6 -4"></path>
                                        <path d="M3 3l18 18"></path>
                                    </svg>
                                </div>
                                <p class="empty-title">No mail settings configured</p>
                                <p class="empty-subtitle text-muted">
                                    Add your first mail configuration to get started
                                </p>
                                <div class="empty-action">
                                    <button class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#add-mail-modal">
                                        <svg xmlns="http://www.w3.org/2000/svg" class="icon" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
                                            <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
                                            <path d="M12 5l0 14"></path>
                                            <path d="M5 12l14 0"></path>
                                        </svg>
                                        Add Mail Settings
                                    </button>
                                </div>
                            </div>
                        }
                        else
                        {
                            <div class="table-responsive">
                                <table class="table table-vcenter table-nowrap">
                                    <thead>
                                        <tr>
                                            <th>Provider</th>
                                            <th>Name</th>
                                            <th>Status</th>
                                            <th>Last Test</th>
                                            <th class="w-1">Actions</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        @foreach (var mailSetting in Model.MailSettingsList)
                                        {
                                            <tr data-mail-id="@mailSetting.Id">
                                                <td>
                                                    <div class="d-flex align-items-center">
                                                        @if (mailSetting.Provider == "SMTP")
                                                        {
                                                            <span class="avatar avatar-sm me-3" style="background-image: url(https://cdn-icons-png.flaticon.com/512/281/281769.png)"></span>
                                                        }
                                                        else if (mailSetting.Provider == "SendGrid")
                                                        {
                                                            <span class="avatar avatar-sm me-3" style="background-image: url(https://cdn.worldvectorlogo.com/logos/sendgrid.svg)"></span>
                                                        }
                                                        else if (mailSetting.Provider == "Azure")
                                                        {
                                                            <span class="avatar avatar-sm me-3" style="background-image: url(https://azure.microsoft.com/svghandler/communication-services/)"></span>
                                                        }
                                                        <div>@mailSetting.Provider</div>
                                                    </div>
                                                </td>
                                                <td>@mailSetting.Name</td>
                                                <td>
                                                    <span class="badge bg-green-lt">
                                                        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-circle-check" width="16" height="16" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
                                                            <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
                                                            <path d="M12 12m-9 0a9 9 0 1 0 18 0a9 9 0 1 0 -18 0"></path>
                                                            <path d="M9 12l2 2l4 -4"></path>
                                                        </svg>
                                                        Active
                                                    </span>
                                                </td>
                                                <td class="text-muted">
                                                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-clock" width="16" height="16" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
                                                        <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
                                                        <path d="M3 12a9 9 0 1 0 18 0a9 9 0 0 0 -18 0"></path>
                                                        <path d="M12 7v5l3 3"></path>
                                                    </svg>
                                                    @DateTime.Now.AddDays(-1).ToString("g")
                                                </td>
                                                <td>
                                                    <div class="btn-list flex-nowrap">
                                                        <a href="#" class="btn btn-sm" data-bs-toggle="modal" data-bs-target="#edit-mail-modal" data-mail-id="@mailSetting.Id">
                                                            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-edit" width="16" height="16" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
                                                                <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
                                                                <path d="M7 7h-1a2 2 0 0 0 -2 2v9a2 2 0 0 0 2 2h9a2 2 0 0 0 2 -2v-1"></path>
                                                                <path d="M20.385 6.585a2.1 2.1 0 0 0 -2.97 -2.97l-8.415 8.385v3h3l8.385 -8.415z"></path>
                                                                <path d="M16 5l3 3"></path>
                                                            </svg>
                                                            Edit
                                                        </a>
                                                        <a href="#" class="btn btn-sm btn-danger" data-bs-toggle="modal" data-bs-target="#delete-mail-modal" data-mail-id="@mailSetting.Id">
                                                            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-trash" width="16" height="16" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
                                                                <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
                                                                <path d="M4 7l16 0"></path>
                                                                <path d="M10 11l0 6"></path>
                                                                <path d="M14 11l0 6"></path>
                                                                <path d="M5 7l1 12a2 2 0 0 0 2 2h8a2 2 0 0 0 2 -2l1 -12"></path>
                                                                <path d="M9 7v-3a1 1 0 0 1 1 -1h4a1 1 0 0 1 1 1v3"></path>
                                                            </svg>
                                                            Delete
                                                        </a>
                                                    </div>
                                                </td>
                                            </tr>
                                        }
                                    </tbody>
                                </table>
                            </div>
                        }
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Add Repo Modal -->
<div class="modal modal-blur fade" id="add-repo-modal" tabindex="-1" role="dialog" aria-hidden="true">
    <div class="modal-dialog modal-lg modal-dialog-centered" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">Connect New Repository</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <form id="add-repo-form" method="post" asp-action="SaveRepoSettings">
                <div class="modal-body">
                    <input name="settings[0].Id" value="@Guid.NewGuid()" type="hidden" />

                    <div class="row mb-3">
                        <div class="col-lg-12">
                            <label class="form-label">Repository Provider</label>
                            <select name="settings[0].RepoType" class="form-select" id="add-repo-type-select">
                                <option value="">Select a provider</option>
                                <option value="GitHub">GitHub</option>
                                <option value="Bitbucket">Bitbucket</option>
                                <option value="GitLab">GitLab</option>
                                <option value="Azure">Azure DevOps</option>
                            </select>
                        </div>
                    </div>

                    <div class="row mb-3">
                        <div class="col-lg-12">
                            <label class="form-label">Connection Name</label>
                            <input class="form-control" name="settings[0].DisplayName" placeholder="e.g. My GitHub Account" />
                            <small class="form-hint">A friendly name to identify this connection</small>
                        </div>
                    </div>

                    <!-- Dynamic form based on repo type -->
                    <div id="add-github-form" class="repo-form" style="display: none;">
                        <div class="row mb-3">
                            <div class="col-lg-12">
                                <label class="form-label">GitHub Personal Access Token</label>
                                <input class="form-control" name="settings[0].AccessToken" placeholder="ghp_..." />
                                <small class="form-hint">
                                    Create a token with <code>repo</code> scope in GitHub settings
                                    <a href="https://github.com/settings/tokens" target="_blank" class="ms-1">Get Token</a>
                                </small>
                            </div>
                        </div>
                    </div>

                    <div id="add-bitbucket-form" class="repo-form" style="display: none;">
                        <div class="row mb-3">
                            <div class="col-lg-12">
                                <label class="form-label">Bitbucket App Password</label>
                                <input class="form-control" name="settings[0].AccessToken" placeholder="App password with repo:write permissions" />
                                <small class="form-hint">
                                    Create an app password in Bitbucket settings
                                    <a href="https://bitbucket.org/account/settings/app-passwords/" target="_blank" class="ms-1">Get Password</a>
                                </small>
                            </div>
                        </div>
                    </div>

                    <div id="add-gitlab-form" class="repo-form" style="display: none;">
                        <div class="row mb-3">
                            <div class="col-lg-12">
                                <label class="form-label">GitLab Personal Access Token</label>
                                <input class="form-control" name="settings[0].AccessToken" placeholder="glpat-..." />
                                <small class="form-hint">
                                    Create a token with <code>api</code> scope in GitLab settings
                                    <a href="https://gitlab.com/-/profile/personal_access_tokens" target="_blank" class="ms-1">Get Token</a>
                                </small>
                            </div>
                        </div>
                    </div>

                    <div id="add-azure-form" class="repo-form" style="display: none;">
                        <div class="row mb-3">
                            <div class="col-lg-12">
                                <label class="form-label">Azure DevOps Personal Access Token</label>
                                <input class="form-control" name="settings[0].AccessToken" placeholder="Azure DevOps PAT" />
                                <small class="form-hint">
                                    In Azure DevOps, create a token with the <code>Code (read)</code> authorization.
                                    <a href="https://dev.azure.com/_usersSettings/tokens" target="_blank" class="ms-1">Create Token</a>
                                </small>
                            </div>
                        </div>

                        <div class="row mb-3">
                            <div class="col-lg-12">
                                <label class="form-label">Azure Username</label>
                                <input class="form-control" name="settings[0].Username" placeholder="user@example.com" />
                            </div>
                        </div>

                        <div class="row mb-3">
                            <div class="col-lg-12">
                                <label class="form-label">Domain Name</label>
                                <input class="form-control" name="settings[0].DomainName" placeholder="gheetah" />
                                <small class="form-hint">Örn: https://dev.azure.com/<strong>gheetah</strong>/...</small>
                            </div>
                        </div>

                        <div class="row mb-3">
                            <div class="col-lg-12">
                                <label class="form-label">Collection Name</label>
                                <input class="form-control" name="settings[0].CollectionName" placeholder="DefaultCollection" />
                            </div>
                        </div>

                        <div class="row mb-3">
                            <div class="col-lg-12">
                                <label class="form-label">Project Name</label>
                                <input class="form-control" name="settings[0].ProjectName" placeholder="TestAutomation" />
                            </div>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-link link-secondary" data-bs-dismiss="modal">
                        Cancel
                    </button>
                    <button type="submit" class="btn btn-primary ms-auto">
                        <svg xmlns="http://www.w3.org/2000/svg" class="icon" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
                            <path stroke="none" d="M0 0h24v24H0z" fill="none" />
                            <path d="M12 5l0 14" />
                            <path d="M5 12l14 0" />
                        </svg>
                        Connect Repository
                    </button>
                </div>
            </form>
        </div>
    </div>
</div>

<!-- Edit Repo Modal -->
<div class="modal modal-blur fade" id="edit-repo-modal" tabindex="-1" role="dialog" aria-hidden="true">
    <div class="modal-dialog modal-lg modal-dialog-centered" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">Edit Repository</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <form id="edit-repo-form" method="post" asp-action="UpdateRepoSettings">
                <div class="modal-body">
                    <input type="hidden" name="settings[0].Id" id="edit-repo-id" value="" />

                    <div class="row mb-3">
                        <div class="col-lg-12">
                            <label class="form-label">Repository Provider</label>
                            <select name="settings[0].RepoType" class="form-select" id="edit-repo-type-select">
                                <option value="">Select a provider</option>
                                <option value="GitHub">GitHub</option>
                                <option value="Bitbucket">Bitbucket</option>
                                <option value="GitLab">GitLab</option>
                                <option value="Azure">Azure DevOps</option>
                            </select>
                        </div>
                    </div>

                    <div class="row mb-3">
                        <div class="col-lg-12">
                            <label class="form-label">Connection Name</label>
                            <input class="form-control" name="settings[0].DisplayName" id="edit-repo-display-name" placeholder="e.g. My GitHub Account" />
                            <small class="form-hint">A friendly name to identify this connection</small>
                        </div>
                    </div>

                    <!-- Dynamic form based on repo type -->
                    <div id="edit-github-form" class="repo-form" style="display: none;">
                        <div class="row mb-3">
                            <div class="col-lg-12">
                                <label class="form-label">GitHub Personal Access Token</label>
                                <input class="form-control" name="settings[0].AccessToken" id="edit-github-token" placeholder="ghp_..." />
                                <small class="form-hint">
                                    Create a token with <code>repo</code> scope in GitHub settings
                                    <a href="https://github.com/settings/tokens" target="_blank" class="ms-1">Get Token</a>
                                </small>
                            </div>
                        </div>
                    </div>

                    <div id="edit-bitbucket-form" class="repo-form" style="display: none;">
                        <div class="row mb-3">
                            <div class="col-lg-12">
                                <label class="form-label">Bitbucket App Password</label>
                                <input class="form-control" name="settings[0].AccessToken" id="edit-bitbucket-token" placeholder="App password with repo:write permissions" />
                                <small class="form-hint">
                                    Create an app password in Bitbucket settings
                                    <a href="https://bitbucket.org/account/settings/app-passwords/" target="_blank" class="ms-1">Get Password</a>
                                </small>
                            </div>
                        </div>
                    </div>

                    <div id="edit-gitlab-form" class="repo-form" style="display: none;">
                        <div class="row mb-3">
                            <div class="col-lg-12">
                                <label class="form-label">GitLab Personal Access Token</label>
                                <input class="form-control" name="settings[0].AccessToken" id="edit-gitlab-token" placeholder="glpat-..." />
                                <small class="form-hint">
                                    Create a token with <code>api</code> scope in GitLab settings
                                    <a href="https://gitlab.com/-/profile/personal_access_tokens" target="_blank" class="ms-1">Get Token</a>
                                </small>
                            </div>
                        </div>
                    </div>

                    <div id="edit-azure-form" class="repo-form" style="display: none;">
                        <div class="row mb-3">
                            <div class="col-lg-12">
                                <label class="form-label">Azure DevOps Personal Access Token</label>
                                <input class="form-control" name="settings[0].AccessToken" id="edit-azure-token" placeholder="Azure DevOps PAT" />
                                <small class="form-hint">
                                    In Azure DevOps, create a token with the <code>Code (read)</code> authorization.
                                    <a href="https://dev.azure.com/_usersSettings/tokens" target="_blank" class="ms-1">Create Token</a>
                                </small>
                            </div>
                        </div>

                        <div class="row mb-3">
                            <div class="col-lg-12">
                                <label class="form-label">Azure Username</label>
                                <input class="form-control" name="settings[0].Username" id="edit-azure-username" placeholder="user@example.com" />
                            </div>
                        </div>

                        <div class="row mb-3">
                            <div class="col-lg-12">
                                <label class="form-label">Domain Name</label>
                                <input class="form-control" name="settings[0].DomainName" id="edit-azure-domain" placeholder="gheetah" />
                                <small class="form-hint">Örn: https://dev.azure.com/<strong>gheetah</strong>/...</small>
                            </div>
                        </div>

                        <div class="row mb-3">
                            <div class="col-lg-12">
                                <label class="form-label">Collection Name</label>
                                <input class="form-control" name="settings[0].CollectionName" id="edit-azure-collection" placeholder="DefaultCollection" />
                            </div>
                        </div>

                        <div class="row mb-3">
                            <div class="col-lg-12">
                                <label class="form-label">Project Name</label>
                                <input class="form-control" name="settings[0].ProjectName" id="edit-azure-project" placeholder="TestAutomation" />
                            </div>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-link link-secondary" data-bs-dismiss="modal">
                        Cancel
                    </button>
                    <button type="submit" class="btn btn-primary ms-auto">
                        <svg xmlns="http://www.w3.org/2000/svg" class="icon" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
                            <path stroke="none" d="M0 0h24v24H0z" fill="none" />
                            <path d="M12 5l0 14" />
                            <path d="M5 12l14 0" />
                        </svg>
                        Update Repository
                    </button>
                </div>
            </form>
        </div>
    </div>
</div>

<!-- Delete Repo Modal -->
<div class="modal modal-blur fade" id="delete-repo-modal" tabindex="-1" role="dialog" aria-hidden="true">
    <div class="modal-dialog modal-sm modal-dialog-centered" role="document">
        <div class="modal-content">
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            <div class="modal-status bg-danger"></div>
            <div class="modal-body text-center py-4">
                <svg xmlns="http://www.w3.org/2000/svg" class="icon mb-2 text-danger icon-lg" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
                    <path stroke="none" d="M0 0h24v24H0z" fill="none" />
                    <path d="M12 9v4" />
                    <path d="M10.363 3.591l-8.106 13.534a1.914 1.914 0 0 0 1.636 2.871h16.214a1.914 1.914 0 0 0 1.636 -2.87l-8.106 -13.536a1.914 1.914 0 0 0 -3.274 0z" />
                    <path d="M12 16h.01" />
                </svg>
                <h3>Are you sure?</h3>
                <form id="delete-repo-form" method="post" asp-action="DeleteRepoSettings">
                    <input type="hidden" id="delete-repo-id" name="id" value="" />
                    <div class="modal-body">
                        <div class="text-muted">Do you really want to delete this Repository settings? This action cannot be undone.</div>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-link link-secondary" data-bs-dismiss="modal">Cancel</button>
                        <button type="submit" class="btn btn-danger ms-auto">Delete</button>
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>

<!-- Add CI/CD Settings Modal -->
<div class="modal modal-blur fade" id="modal-add-cicd" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog modal-lg modal-dialog-centered">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">Add New CI/CD Configuration</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>

            <form id="cicd-form" method="post" asp-action="CreateCiCdSettings">
                <div class="modal-body">
                    <!-- Provider Selection Cards -->
                    <div class="mb-4">
                        <label class="form-label required">CI/CD Provider</label>
                        <div class="row g-3">
                            <!-- Azure DevOps Card -->
                            <div class="col-md-4">
                                <label class="form-check form-check-inline form-check-card">
                                    <input class="form-check-input" type="radio" name="settings[0].ToolType" value="Azure" checked>
                                    <span class="form-check-card-content">
                                        <svg width="128" height="128" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg"><title>file_type_azure</title><path d="M14.98,25.994c3.57-.726,6.518-1.327,6.552-1.335l.062-.015-3.37-4.615c-1.854-2.538-3.37-4.625-3.37-4.637s3.48-11.056,3.5-11.095c.007-.013,2.375,4.694,5.741,11.411l5.774,11.521.044.088-10.711,0-10.711,0Z" style="fill:#0089d6"/><path d="M2.125,24.586c0-.006,1.588-3.18,3.529-7.053l3.529-7.041L13.3,6.52c2.262-2.185,4.119-3.976,4.126-3.979a.914.914,0,0,1-.066.192L12.89,13.759,8.5,24.589l-3.189,0C3.56,24.6,2.125,24.593,2.125,24.586Z" style="fill:#0089d6"/></svg>
                                        <span class="mt-2">Azure DevOps</span>
                                    </span>
                                </label>
                            </div>

                            <!-- Jenkins Card -->
                            <div class="col-md-4">
                                <label class="form-check form-check-inline form-check-card">
                                    <input class="form-check-input" type="radio" name="settings[0].ToolType" value="Jenkins">
                                    <span class="form-check-card-content">
                                        <svg width="128" height="128" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg"><title>file_type_jenkins</title><path d="M19.513,25.173c-.068,0-.136,0-.2-.01C19.378,25.169,19.445,25.173,19.513,25.173Z" style="fill:none" /><path d="M18.919,25.087a1.93,1.93,0,0,0,.392.076A1.93,1.93,0,0,1,18.919,25.087Z" style="fill:none" /><path d="M20.091,27.511c-.021-.121-.043-.221-.064-.31h0c.021.089.043.189.064.31Z" style="fill:none" /><path d="M7.436,14.214A.832.832,0,0,1,7.6,14.1.581.581,0,0,0,7.436,14.214Z" style="fill:#f0d6b7" /><path d="M10.412,18.253c.06.421.24,4.164,2.766,6.25a15.465,15.465,0,0,0,1.549.162c.28-.6,1.312-.554,1.985-.4a6.648,6.648,0,0,1-2.176-1.778,4.466,4.466,0,0,1-1.472-2.656c1.348,1.87,2.462,3.5,4.913,4.326,1.855.622,4.021-.285,5.446-1.286a6.258,6.258,0,0,0,1.365-1.68,14.242,14.242,0,0,0,2.145-8.621,9.567,9.567,0,0,0-.5-3.446c-.453-.908-1.984-1.72-2.88-.9a1.07,1.07,0,0,1-.016-.246c-.143.134-.23.232-.23.232a1.209,1.209,0,0,1-.122-.487,1.551,1.551,0,0,1,1.5-1.5,8.674,8.674,0,0,0-1.479-1.563,10.49,10.49,0,0,0-6.047-.222,8.06,8.06,0,0,0-5.975,5.4,14.085,14.085,0,0,0-.388,2.263c-.031.884.416,1.655.45,2.617-.239.394-.969.443-1.474.416-.037-.187-.082-.379-.136-.566a5.158,5.158,0,0,0-1.265-.5,1.719,1.719,0,0,1,1.009,2.038c-.373-.213-.462-1.15-.9-1.177-.626-.038-.512,1.216-.509,1.95a2.291,2.291,0,0,1-.19-2.213c-.284-.139-.444.061-.6.217-.222,1.036-.547,1.873.062,2.92a1.734,1.734,0,0,0,1.414.6c.567-.056.706-.624,1.324-.618A.513.513,0,0,1,10.412,18.253ZM16.861,20.2l-.3-.061s-.314-1.1-.163-1.306c.08-.107.52-.268,1.136.028C17.53,18.862,16.8,18.984,16.861,20.2Zm5.706,1.341a5.27,5.27,0,0,1-3.426-.014A4.687,4.687,0,0,1,17.858,20.1c-.155-.2-.927-.708-.012-.709h0c.717,1.8,3.18,1.592,5.257,1.543A1.111,1.111,0,0,1,22.567,21.542Zm.3-1.6a4.016,4.016,0,0,1,0-1.063,8.538,8.538,0,0,0,2.96-1.185h0A3.425,3.425,0,0,1,22.866,19.939Zm2.756-8.073c-.183.061-1.37.762-1.278-.122a1.348,1.348,0,0,1,1.026-1.077,3.037,3.037,0,0,1,0-.4h0l.079,0a17.146,17.146,0,0,0,1.172,2.29c-.317.738-2.4,1.39-2.366.066.45-.2,1.227-.04,1.626-.291-.094-.257-.2-.5-.3-.756Zm-5.187,4.75a.719.719,0,0,1,.046.1c.091-.507.259-1.1.548-1.013a.684.684,0,0,1,.5.638,6.908,6.908,0,0,0-.948.738c.065.3.144.6.523.668,1.106.189,2.393-.677,3.189-.979.493-.832-.043-1.138-.487-1.673-.91-1.1-2.13-2.456-2.086-4.1.368-.267.4.407.452.53a15.006,15.006,0,0,0,2.543,3.486c.214.234.567.459.606.614.113.451-.294.991-.247,1.29h0a6.587,6.587,0,0,1-4.466,1.4A1.322,1.322,0,0,1,20.434,16.615Zm1.958,2.321A4.933,4.933,0,0,1,22.47,20c-1.811.09-3.952-.358-4.427-1.629A10.285,10.285,0,0,0,22.393,18.936Zm-4.256-8.648a6.954,6.954,0,0,0,.977,1.829c.228.222.67.492.451,1.109a1.406,1.406,0,0,1-.642.534c-.79.233-2.631.048-2.008-.937.653.03,1.532.424,2.02-.05-.095-.152-.209-.341-.322-.551-.5.316-1.874.33-1.874-.479,0-.852,1.339-1.034,1.339-1.034l.01.024A1.11,1.11,0,0,1,18.137,10.288ZM14.914,7.363c1.195-.815,1.8-.35,2.1.188a.568.568,0,0,1,.274.828c-1.658-.386-2.482.694-2.985,1.814-.129.234-.136.068-.21-.136a.392.392,0,0,1-.061-.136A.551.551,0,0,0,13.94,9.8C13.7,9.553,13.575,8.276,14.914,7.363Z" style="fill:#f0d6b7" /><path d="M6.283,29.28h8.753c-.04-.135-.079-.268-.118-.394a12.164,12.164,0,0,1-.476-1.948,21.079,21.079,0,0,1-3.087-1.655,2.353,2.353,0,0,1-.24-.257L5.849,27.379S6.038,28.133,6.283,29.28Z" style="fill:#335061" /><path d="M9.433,7A2.125,2.125,0,0,1,9.9,6.912a3.817,3.817,0,0,0,.747.029c.494-.123.912-1.231,1.285-1.644a11.333,11.333,0,0,1,.941-.776A7.346,7.346,0,0,0,9.433,7Z" style="fill:#6d6b6d" /><path d="M7.177,12.586a2.147,2.147,0,0,1,3.145,1.747c.694-.018.259-.866.134-1.413-.369-1.608.487-3.34.192-4.861C6.782,8.637,7,11.606,7.177,12.586Z" style="fill:#6d6b6d" /><path d="M13.249,3.851c-1.82.516-4.152,1.838-4.9,3.473A7.389,7.389,0,0,0,9.433,7a7.346,7.346,0,0,1,3.44-2.479,1.647,1.647,0,0,0,.159-.166c.192-.093.476-.086.487-.375C13.436,3.891,13.348,3.823,13.249,3.851Z" style="fill:#dcd9d8" /><path d="M7.5,8.985c-.8.885-.636,2.542-.538,3.721a2.321,2.321,0,0,1,.218-.12c-.18-.979-.394-3.949,3.471-4.527a2.81,2.81,0,0,0-.142-.493A4.409,4.409,0,0,0,7.5,8.985Z" style="fill:#dcd9d8" /><path d="M10.412,18.253a.513.513,0,0,0-.42-.468c.335.668-.516.878-.6,1.355a3.837,3.837,0,0,0,.125.832,11.351,11.351,0,0,0,1.445,3.365,3.181,3.181,0,0,0,2.22,1.166C10.652,22.418,10.472,18.674,10.412,18.253Z" style="fill:#f7e4cd" /><path d="M21.525,16.338a.684.684,0,0,0-.5-.638c-.289-.082-.457.506-.548,1.013a2.376,2.376,0,0,1,.1.363A6.908,6.908,0,0,1,21.525,16.338Z" style="fill:#f7e4cd" /><path d="M24.344,11.744c-.092.884,1.1.183,1.278.122l-.043-.286a3.235,3.235,0,0,1-.209-.913A1.348,1.348,0,0,0,24.344,11.744Z" style="fill:#f7e4cd" /><path d="M16.739,11.744c0,.809,1.371.795,1.874.479a4.053,4.053,0,0,1-.525-1.489l-.01-.024S16.739,10.892,16.739,11.744Z" style="fill:#f7e4cd" /><path d="M7.192,14.885a.8.8,0,0,1-.125.109,1.221,1.221,0,0,1,.37-.781A.581.581,0,0,1,7.6,14.1a.979.979,0,0,1,.782-.032,5.158,5.158,0,0,1,1.265.5c-.193-.664-.524-1.263-1.208-1.338a2.034,2.034,0,0,0-2.2,1.963A3.858,3.858,0,0,0,7.254,17.8C6.644,16.758,6.97,15.921,7.192,14.885Z" style="fill:#f7e4cd" /><path d="M17.165,4.443a10.49,10.49,0,0,1,6.047.222,4.127,4.127,0,0,0-.49-.329c-1.889-1.066-5.086-1.867-7.1-.866-1.621.808-3.813,2.146-4.56,3.841a4.109,4.109,0,0,1,.123,2.532A8.06,8.06,0,0,1,17.165,4.443Z" style="fill:#f7e4cd" /><path d="M23.188,7.728a1.209,1.209,0,0,0,.122.487s.087-.1.23-.232c.031-.734.865-1.152,1.832-.866-.222-.286-.447-.589-.681-.889A1.551,1.551,0,0,0,23.188,7.728Z" style="fill:#f7e4cd" /><path d="M14.092,10.058c.074.2.082.37.21.136A.348.348,0,0,1,14.092,10.058Z" style="fill:#f7e4cd" /><path d="M14.032,9.922a1.486,1.486,0,0,1,.114-.758,2.816,2.816,0,0,1,2.47-1.755,1.149,1.149,0,0,1,.4.143c-.3-.538-.9-1-2.1-.188-1.338.913-1.217,2.19-.973,2.434A.551.551,0,0,1,14.032,9.922Z" style="fill:#f7e4cd" /><path d="M5.849,27.379l5.266-2.353c-.386-.448-1.079-1.3-1.2-1.257a24.079,24.079,0,0,0-5.61,3.485,20.236,20.236,0,0,1,.81,2.026H6.283C6.038,28.133,5.849,27.379,5.849,27.379Z" style="fill:#49728b" /><path d="M27,29.307a20.836,20.836,0,0,0,.548-2.058c.036-.181.106-.475.156-.756l-2.886-2.144a5.123,5.123,0,0,1,.13,3.9c.1.372.454.515.6.85-.034.06-.068.119-.1.179h1.476A.149.149,0,0,1,27,29.307Z" style="fill:#335061" /><path d="M24.441,28.074a1.081,1.081,0,0,0,.172-.381,1.081,1.081,0,0,1-.172.381Z" style="fill:#335061" /><path d="M23.617,23.946a.948.948,0,0,1,.514-.106l-.238-.177A1.457,1.457,0,0,0,23.617,23.946Z" style="fill:#335061" /><path d="M27.756,25.879c-.074-.537-.8-.935-1.172-1.266C25.9,24,25.472,23.46,24.761,22.887a4.391,4.391,0,0,1-.869.776l.238.177a.932.932,0,0,1,.686.51L27.7,26.493A2.339,2.339,0,0,0,27.756,25.879Z" style="fill:#49728b" /><path d="M20.572,29.2a.438.438,0,0,0,.009.076h.479a.333.333,0,0,1,.666,0H22.5v-.03c-.274-.144-.873-.455-1.2-.593C20.876,28.475,20.572,29.2,20.572,29.2Z" style="fill:#fff" /><path d="M20.572,29.2s.3-.73.73-.548c.322.138.921.449,1.2.593.01-.22.02-.44.034-.66-.618.039-.961-.559-1.394-.605-.378-.041-.7.435-1.19.229-.113.124-.215.259-.33.381a6.313,6.313,0,0,1,.489.685h.476A.438.438,0,0,1,20.572,29.2Z" style="fill:#dcd9d8" /><path d="M14.511,25.169a6.738,6.738,0,0,1-2.269-.4.282.282,0,0,0,.017.421,7.657,7.657,0,0,0,2.14.578A1.748,1.748,0,0,0,14.511,25.169Z" style="fill:#fff" /><path d="M14.357,26.069a1.233,1.233,0,0,1,.041-.3,7.657,7.657,0,0,1-2.14-.578A4.237,4.237,0,0,0,14.357,26.069Z" style="fill:#dcd9d8" /><path d="M24.613,27.693a2.963,2.963,0,0,0,.073-.87,7.057,7.057,0,0,0-.2-1.378,3,3,0,0,0-1.009.049c-.3.061-.609.122-.669.487s.122.548-.061.852-.487.122-.791.3c-.207.124-.076.445.029.638a12.138,12.138,0,0,0,2.459.3A1.081,1.081,0,0,0,24.613,27.693Z" style="fill:#d33833" /><path d="M15.562,29.219c.016.043.033.088.047.128s.029.093.042.139l-.009-.117Z" style="fill:#d33833" /><path d="M19.563,27.925q.01-.264.021-.527a1.309,1.309,0,0,1-.96-.074c-.937-.511-.05-.36-.382-1.038a3.236,3.236,0,0,0-1.224-.365c-1.228,0-1.7-.247-1.568,1.169.069.76.131,1.519.191,2.28.1.188.19.357.262.5a4.834,4.834,0,0,0,1.833-.559A21.007,21.007,0,0,0,19.563,27.925Z" style="fill:#d33833" /><path d="M20.027,27.2c.021.089.043.189.064.31h0a.7.7,0,1,0,.428-1.31A.953.953,0,0,1,20.027,27.2Z" style="fill:#d33833" /><path d="M21.953,27.137c.3-.183.609,0,.791-.3s0-.487.061-.852.365-.426.669-.487a3,3,0,0,1,1.009-.049,1.125,1.125,0,0,0-.348-.652c-.747-.436-2.056.825-2.665,1.093l-.057.023a1.694,1.694,0,0,1,.175.558A1.475,1.475,0,0,1,22,26.429a1.761,1.761,0,0,1,.276.033c.045.009.089.02.133.032a1.463,1.463,0,0,1,.243.092,4.209,4.209,0,0,0-.757.1.7.7,0,0,0-.2.095,8.618,8.618,0,0,0-.035.9q.158.045.322.084C21.877,27.582,21.746,27.261,21.953,27.137Z" style="fill:#ef3d3a" /><path d="M15.651,29.485c.051.183.095.348.253.385-.072-.144-.163-.313-.262-.5Z" style="fill:#ef3d3a" /><path d="M15.45,27.089c-.129-1.416.34-1.169,1.568-1.169a3.236,3.236,0,0,1,1.224.365c.332.678-.555.527.382,1.038a1.309,1.309,0,0,0,.96.074l0-.063a3.039,3.039,0,0,0-.916-.29,3.5,3.5,0,0,0-.371-.036,1.555,1.555,0,0,1,.291-.106,3.285,3.285,0,0,0,.906-.281c0-.079.006-.158.009-.236a1.883,1.883,0,0,1-.2-.027,1.565,1.565,0,0,1-.177-.044,1.585,1.585,0,0,1-.294-.127c-.178-.1-.331-.216-.525-.322a9.077,9.077,0,0,0-2.408-.881c-.921-.176-.929,1.105-.89,2.049,0,.1.008.192.013.28a6.585,6.585,0,0,0,.544,1.9l.079.15C15.582,28.609,15.519,27.849,15.45,27.089Z" style="fill:#ef3d3a" /><path d="M20.52,26.2a1.009,1.009,0,0,0-.582.2,1.7,1.7,0,0,0,.007.412c.011.079.028.155.048.238l.031.131,0,.017h0A.953.953,0,0,0,20.52,26.2Z" style="fill:#ef3d3a" /><path d="M14.146,9.164a1.486,1.486,0,0,0-.114.758.392.392,0,0,0,.061.136.348.348,0,0,0,.21.136c.5-1.12,1.327-2.2,2.985-1.814a.568.568,0,0,0-.274-.828,1.149,1.149,0,0,0-.4-.143A2.816,2.816,0,0,0,14.146,9.164Z" style="fill:#231f20" /><path d="M24.252,12.627c-.032,1.324,2.049.672,2.366-.066a17.146,17.146,0,0,1-1.172-2.29l-.079,0h0a3.037,3.037,0,0,0,0,.4,3.235,3.235,0,0,0,.209.913c.095.256.205.5.3.756C25.479,12.587,24.7,12.43,24.252,12.627Z" style="fill:#231f20" /><path d="M18.934,12.773c-.488.474-1.367.08-2.02.05-.623.985,1.218,1.17,2.008.937a1.406,1.406,0,0,0,.642-.534c.219-.617-.223-.887-.451-1.109a6.954,6.954,0,0,1-.977-1.829,1.11,1.11,0,0,0-.049.445,4.053,4.053,0,0,0,.525,1.489C18.726,12.432,18.839,12.621,18.934,12.773Z" style="fill:#231f20" /><path d="M20.605,18.315a6.587,6.587,0,0,0,4.466-1.4h0c-.047-.3.36-.84.247-1.29-.039-.155-.392-.38-.606-.614a15.006,15.006,0,0,1-2.543-3.486c-.053-.123-.085-.8-.452-.53-.044,1.642,1.176,3,2.086,4.1.444.535.98.841.487,1.673-.8.3-2.083,1.169-3.189.979-.379-.065-.458-.365-.523-.668a2.376,2.376,0,0,0-.1-.363.719.719,0,0,0-.046-.1A1.322,1.322,0,0,0,20.605,18.315Z" style="fill:#231f20" /><path d="M7.6,14.1a.832.832,0,0,0-.159.111,1.221,1.221,0,0,0-.37.781.8.8,0,0,0,.125-.109c.153-.156.313-.357.6-.217a2.291,2.291,0,0,0,.19,2.213c0-.733-.117-1.987.509-1.95.438.027.527.964.9,1.177A1.719,1.719,0,0,0,8.378,14.07.979.979,0,0,0,7.6,14.1Z" style="fill:#231f20" /><path d="M22.868,18.875a4.016,4.016,0,0,0,0,1.063,3.425,3.425,0,0,0,2.962-2.249h0A8.538,8.538,0,0,1,22.868,18.875Z" style="fill:#231f20" /><path d="M22.47,20a4.933,4.933,0,0,0-.077-1.066,10.285,10.285,0,0,1-4.35-.562C18.518,19.644,20.659,20.092,22.47,20Z" style="fill:#231f20" /><path d="M17.846,19.39h0c-.915,0-.143.51.012.709a4.687,4.687,0,0,0,1.284,1.428,5.27,5.27,0,0,0,3.426.014,1.111,1.111,0,0,0,.536-.609C21.026,20.982,18.563,21.189,17.846,19.39Z" style="fill:#231f20" /><path d="M24.96,29.28a1.709,1.709,0,0,0-1.042-.753,1.433,1.433,0,0,0-.918.12c-.008.2-.018.415-.031.632Z" style="fill:#81b0c4" /><path d="M21.971,24.749c-.686.061-1.493.373-2.252.419-.069,0-.138.006-.206.006s-.136,0-.2-.01a1.93,1.93,0,0,1-.392-.076,1.666,1.666,0,0,1-.188-.07c0,.052-.071.033-.082.076.085.066.167.126.247.179s.159.1.238.143a2.218,2.218,0,0,0,.475.19,3.052,3.052,0,0,0,.816.09c.1,0,.212,0,.327-.009C21.169,25.384,21.537,25.031,21.971,24.749Z" style="fill:#f0d6b7" /><path d="M19.086,29.048l-.351.233h.527Q19.176,29.162,19.086,29.048Z" style="fill:#81b0c4" /><path d="M4.681,29.769v-.335a.153.153,0,0,1,.153-.153h.283a20.236,20.236,0,0,0-.81-2.026,24.079,24.079,0,0,1,5.61-3.485c.118-.047.811.809,1.2,1.257a2.353,2.353,0,0,0,.24.257,21.079,21.079,0,0,0,3.087,1.655,12.164,12.164,0,0,0,.476,1.948c.039.126.078.26.118.394H15.2a.153.153,0,0,1,.153.153v.158h.139a.153.153,0,0,1,.153.153V30h1.691v-.255a.153.153,0,0,1,.153-.153h.78v-.158a.153.153,0,0,1,.153-.153h.317l.351-.233q.09.114.176.233h.843a6.313,6.313,0,0,0-.489-.685c.115-.122.217-.256.33-.381.492.206.812-.27,1.19-.229.433.046.776.644,1.394.605-.014.22-.024.44-.034.66v.03h.474c.012-.217.023-.429.031-.632a1.433,1.433,0,0,1,.918-.12,1.709,1.709,0,0,1,1.042.753h.481c.034-.06.069-.119.1-.179-.143-.335-.495-.477-.6-.85a5.123,5.123,0,0,0-.13-3.9.932.932,0,0,0-.686-.51.948.948,0,0,0-.514.106,1.457,1.457,0,0,1,.275-.283,4.391,4.391,0,0,0,.869-.776c.712.573,1.141,1.112,1.824,1.725.37.332,1.1.73,1.172,1.266a2.339,2.339,0,0,1-.054.614c-.051.281-.12.575-.156.756A20.836,20.836,0,0,1,27,29.307a.15.15,0,0,1,.072.127V30h.368c.258-.808.511-1.635.766-2.489a6.207,6.207,0,0,0,.478-2.187c-.078-.617-1.04-1.265-1.547-1.754-.281-.271-1.593-1.267-1.669-1.64s.535-1.178.731-1.586a11.669,11.669,0,0,0,.621-1.788c1.032-3.627,1.137-8.611-.339-11.592a12.54,12.54,0,0,0-3.1-3.428c-2.3-1.742-6.563-1.935-9.339-.913a13.481,13.481,0,0,0-2.2.939C10.024,4.628,8.094,5.342,7.555,7.49c-1.328.6-1.729,2.3-1.662,4.268a6.221,6.221,0,0,1,.149,1.227c-.037.184-.286.419-.336.538a5.3,5.3,0,0,0,.609,4.592A3.225,3.225,0,0,0,8.468,19.5a4.568,4.568,0,0,0,.447,1.672c.17.373.805,1.043.571,1.519a6.987,6.987,0,0,1-1.495.966c-1.158.695-2,1.12-3.066,1.89-.692.5-1.773.562-1.6,1.71a17.869,17.869,0,0,0,.808,2.513c.025.078.053.155.08.232h.47ZM13.032,4.355a1.647,1.647,0,0,1-.159.166,11.333,11.333,0,0,0-.941.776c-.373.413-.79,1.521-1.285,1.644A3.817,3.817,0,0,1,9.9,6.912,2.125,2.125,0,0,0,9.433,7a7.389,7.389,0,0,1-1.084.325c.748-1.635,3.08-2.957,4.9-3.473.1-.028.188.04.271.129C13.509,4.268,13.224,4.262,13.032,4.355Zm-2.385,3.7c.3,1.521-.561,3.254-.192,4.861.125.546.56,1.394-.134,1.413a2.147,2.147,0,0,0-3.145-1.747,2.321,2.321,0,0,0-.218.12c-.1-1.179-.266-2.836.538-3.721a4.409,4.409,0,0,1,3.009-1.419A2.81,2.81,0,0,1,10.647,8.059ZM7.254,17.8A3.858,3.858,0,0,1,6.232,15.2a2.034,2.034,0,0,1,2.2-1.963c.684.075,1.014.674,1.208,1.338.054.187.1.379.136.566.505.027,1.235-.022,1.474-.416-.034-.962-.481-1.733-.45-2.617a14.085,14.085,0,0,1,.388-2.263,4.109,4.109,0,0,0-.123-2.532c.747-1.695,2.939-3.032,4.56-3.841,2.009-1,5.207-.2,7.1.866a4.127,4.127,0,0,1,.49.329,8.674,8.674,0,0,1,1.479,1.563c.234.3.459.6.681.889-.967-.287-1.8.132-1.832.866a1.07,1.07,0,0,0,.016.246c.9-.821,2.427-.009,2.88.9a9.567,9.567,0,0,1,.5,3.446,14.242,14.242,0,0,1-2.145,8.621,6.258,6.258,0,0,1-1.365,1.68c-1.425,1-3.591,1.908-5.446,1.286-2.451-.823-3.565-2.456-4.913-4.326a4.466,4.466,0,0,0,1.472,2.656,6.648,6.648,0,0,0,2.176,1.778c-.673-.158-1.7-.208-1.985.4a15.465,15.465,0,0,1-1.549-.162,3.181,3.181,0,0,1-2.22-1.166,11.351,11.351,0,0,1-1.445-3.365,3.837,3.837,0,0,1-.125-.832c.088-.478.939-.687.6-1.355-.618-.006-.757.562-1.324.618A1.734,1.734,0,0,1,7.254,17.8Zm12.77,9.38-.031-.131c-.02-.083-.036-.159-.048-.238a1.7,1.7,0,0,1-.007-.412,1.009,1.009,0,0,1,.582-.2.7.7,0,1,1-.428,1.31c-.021-.121-.043-.221-.064-.31Zm-7.782-2.419a6.738,6.738,0,0,0,2.269.4,1.748,1.748,0,0,1-.112.6,1.233,1.233,0,0,0-.041.3,4.237,4.237,0,0,1-2.1-.882A.282.282,0,0,1,12.242,24.766Zm7.367.839a2.218,2.218,0,0,1-.475-.19c-.078-.042-.157-.09-.238-.143s-.162-.113-.247-.179c.011-.043.079-.024.082-.076a1.666,1.666,0,0,0,.188.07,1.93,1.93,0,0,0,.392.076c.067.006.134.009.2.01s.137,0,.206-.006c.759-.046,1.566-.358,2.252-.419-.433.283-.8.636-1.218.938-.115.006-.224.009-.327.009A3.052,3.052,0,0,1,19.609,25.605Zm-1.872,3.706a4.834,4.834,0,0,1-1.833.559c-.158-.037-.2-.2-.253-.385-.013-.046-.026-.092-.042-.139s-.03-.085-.047-.128a6.585,6.585,0,0,1-.544-1.9c0-.088-.009-.182-.013-.28-.039-.944-.031-2.225.89-2.049a9.077,9.077,0,0,1,2.408.881c.194.106.347.225.525.322a1.585,1.585,0,0,0,.294.127,1.565,1.565,0,0,0,.177.044,1.883,1.883,0,0,0,.2.027c0,.078-.006.157-.009.236a3.285,3.285,0,0,1-.906.281,1.555,1.555,0,0,0-.291.106,3.5,3.5,0,0,1,.371.036,3.039,3.039,0,0,1,.916.29l0,.063q-.01.264-.021.527A21.007,21.007,0,0,1,17.737,29.311Zm4.245-1.536q-.164-.039-.322-.084a8.618,8.618,0,0,1,.035-.9.7.7,0,0,1,.2-.095,4.209,4.209,0,0,1,.757-.1,1.463,1.463,0,0,0-.243-.092c-.043-.012-.088-.023-.133-.032A1.761,1.761,0,0,0,22,26.429a1.475,1.475,0,0,0-.407.038,1.694,1.694,0,0,0-.175-.558l.057-.023c.609-.268,1.918-1.529,2.665-1.093a1.125,1.125,0,0,1,.348.652,7.057,7.057,0,0,1,.2,1.378,2.963,2.963,0,0,1-.073.87,1.081,1.081,0,0,1-.172.381h0A12.138,12.138,0,0,1,21.982,27.774Z" style="fill:#231f20" /><path d="M17.53,18.862c-.616-.3-1.056-.135-1.136-.028-.152.2.163,1.306.163,1.306l.3.061C16.8,18.984,17.53,18.862,17.53,18.862Z" style="fill:#f7e4cd" /><path d="M21.393,28.961a.334.334,0,0,0-.333.319h.666A.334.334,0,0,0,21.393,28.961Z" style="fill:#1d1919" /><path d="M15.642,29.745a.153.153,0,0,0-.153-.153h-.139v.177a.153.153,0,0,1-.153.153H4.834a.153.153,0,0,1-.153-.153V30H15.642Z" style="fill:#231f20" /><path d="M26.918,29.922h-8.5a.153.153,0,0,1-.153-.153v-.177h-.78a.153.153,0,0,0-.153.153V30h9.737v-.231A.153.153,0,0,1,26.918,29.922Z" style="fill:#231f20" /><path d="M4.834,29.922H15.2a.153.153,0,0,0,.153-.153v-.335a.153.153,0,0,0-.153-.153H4.834a.153.153,0,0,0-.153.153v.335A.153.153,0,0,0,4.834,29.922Z" style="fill:#231f20" /><path d="M18.266,29.769a.153.153,0,0,0,.153.153h8.5a.153.153,0,0,0,.153-.153v-.335A.15.15,0,0,0,27,29.307a.149.149,0,0,0-.081-.026h-8.5a.153.153,0,0,0-.153.153v.335Z" style="fill:#231f20" /></svg>
                                        <span class="mt-2">Jenkins</span>
                                    </span>
                                </label>
                            </div>

                            <!-- GitLab Card -->
                            <div class="col-md-4">
                                <label class="form-check form-check-inline form-check-card">
                                    <input class="form-check-input" type="radio" name="settings[0].ToolType" value="GitLab">
                                    <span class="form-check-card-content">
                                        <svg width="128" height="128" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg" fill="none"><path fill="#FC6D26" d="M14.975 8.904L14.19 6.55l-1.552-4.67a.268.268 0 00-.255-.18.268.268 0 00-.254.18l-1.552 4.667H5.422L3.87 1.879a.267.267 0 00-.254-.179.267.267 0 00-.254.18l-1.55 4.667-.784 2.357a.515.515 0 00.193.583l6.78 4.812 6.778-4.812a.516.516 0 00.196-.583z"/><path fill="#E24329" d="M8 14.296l2.578-7.75H5.423L8 14.296z"/><path fill="#FC6D26" d="M8 14.296l-2.579-7.75H1.813L8 14.296z"/><path fill="#FCA326" d="M1.81 6.549l-.784 2.354a.515.515 0 00.193.583L8 14.3 1.81 6.55z"/><path fill="#E24329" d="M1.812 6.549h3.612L3.87 1.882a.268.268 0 00-.254-.18.268.268 0 00-.255.18L1.812 6.549z"/><path fill="#FC6D26" d="M8 14.296l2.578-7.75h3.614L8 14.296z"/><path fill="#FCA326" d="M14.19 6.549l.783 2.354a.514.514 0 01-.193.583L8 14.296l6.188-7.747h.001z"/><path fill="#E24329" d="M14.19 6.549H10.58l1.551-4.667a.267.267 0 01.255-.18c.115 0 .217.073.254.18l1.552 4.667z"/></svg>
                                        <span class="mt-2">GitLab</span>
                                    </span>
                                </label>
                            </div>
                        </div>
                    </div>

                    <!-- Common Fields -->
                    <div class="row g-3">
                        <div class="col-md-12">
                            <label class="form-label required">Configuration Name</label>
                            <input type="text" class="form-control" name="settings[0].Name" placeholder="e.g. Production Pipeline" required>
                        </div>

                        <div class="col-md-12">
                            <label class="form-label required">API URL</label>
                            <input type="url" class="form-control" name="settings[0].ApiUrl" placeholder="https://api.example.com" required>
                        </div>

                        <div class="col-md-12">
                            <label class="form-label required">Access Token</label>
                            <div class="input-group">
                                <input type="password" class="form-control" name="settings[0].AccessToken" placeholder="Your access token" required>
                                <button class="btn btn-outline-secondary" type="button" id="toggleAddTokenVisibility">
                                    <svg xmlns="http://www.w3.org/2000/svg" class="icon" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
                                        <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
                                        <path d="M10 12a2 2 0 1 0 4 0a2 2 0 0 0 -4 0"></path>
                                        <path d="M21 12c-2.4 4 -5.4 6 -9 6c-3.6 0 -6.6 -2 -9 -6c2.4 -4 5.4 -6 9 -6c3.6 0 6.6 2 9 6"></path>
                                    </svg>
                                </button>
                            </div>
                        </div>
                    </div>

                    <!-- Azure DevOps Specific Fields -->
                    <div id="azure-fields" class="cicd-provider-fields">
                        <div class="row g-3 mt-3">
                            <div class="col-md-6">
                                <label class="form-label required">Organization</label>
                                <input type="text" class="form-control" name="settings[0].Organization" placeholder="your-organization">
                            </div>

                            <div class="col-md-6">
                                <label class="form-label required">Project</label>
                                <input type="text" class="form-control" name="settings[0].Project" placeholder="your-project">
                            </div>

                            <div class="col-md-6">
                                <label class="form-label">Collection Name</label>
                                <input type="text" class="form-control" name="settings[0].CollectionName" placeholder="DefaultCollection">
                            </div>
                        </div>
                    </div>

                    <!-- Jenkins Specific Fields -->
                    <div id="jenkins-fields" class="cicd-provider-fields d-none">
                        <div class="row g-3 mt-3">
                            <div class="col-md-6">
                                <label class="form-label required">Job Name</label>
                                <input type="text" class="form-control" name="settings[0].JobName" placeholder="your-job-name">
                            </div>

                            <div class="col-md-6">
                                <label class="form-label">Jenkins Username</label>
                                <input type="text" class="form-control" name="settings[0].JenkinsUsername" placeholder="jenkins-user">
                            </div>

                            <div class="col-md-6">
                                <label class="form-label">Crumb</label>
                                <input type="text" class="form-control" name="settings[0].Crumb" placeholder="Jenkins crumb">
                            </div>
                        </div>
                    </div>

                    <!-- GitLab Specific Fields -->
                    <div id="gitlab-fields" class="cicd-provider-fields d-none">
                        <div class="row g-3 mt-3">
                            <div class="col-md-6">
                                <label class="form-label">Group ID</label>
                                <input type="text" class="form-control" name="settings[0].GroupId" placeholder="12345">
                            </div>

                            <div class="col-md-6">
                                <label class="form-label">Project ID</label>
                                <input type="text" class="form-control" name="settings[0].ProjectId" placeholder="67890">
                            </div>
                        </div>
                    </div>
                </div>

                <div class="modal-footer">
                    <button type="button" class="btn btn-link link-secondary" data-bs-dismiss="modal">Cancel</button>
                    <button type="submit" class="btn btn-primary ms-auto">
                        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-device-floppy" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
                            <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
                            <path d="M6 4h10l4 4v10a2 2 0 0 1 -2 2h-12a2 2 0 0 1 -2 -2v-12a2 2 0 0 1 2 -2"></path>
                            <path d="M12 14m-2 0a2 2 0 1 0 4 0a2 2 0 1 0 -4 0"></path>
                            <path d="M14 4l0 4l-6 0l0 -4"></path>
                        </svg>
                        Save Configuration
                    </button>
                </div>
            </form>
        </div>
    </div>
</div>

<!-- Edit CI/CD Settings Modal -->
<div class="modal modal-blur fade" id="edit-cicd-modal" tabindex="-1" role="dialog" aria-hidden="true">
    <div class="modal-dialog modal-lg modal-dialog-centered" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">Update CI/CD Setting</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <form id="edit-cicd-form" method="post" asp-action="UpdateCiCdSettings">
                <div class="modal-body">
                    <input type="hidden" name="settings[0].Id" id="edit-cicd-id" value="" />
                    <!-- Provider Selection Cards -->
                    <div class="mb-4">
                        <label class="form-label required">CI/CD Provider</label>
                        <div class="row g-3">
                            <!-- Azure DevOps Card -->
                            <div class="col-md-4">
                                <label class="form-check form-check-inline form-check-card">
                                    <input id="edit-cicd-azure" class="form-check-input" type="radio" name="settings[0].ToolType" value="Azure" checked>
                                    <span class="form-check-card-content">
                                        <svg width="128" height="128" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg"><title>file_type_azure</title><path d="M14.98,25.994c3.57-.726,6.518-1.327,6.552-1.335l.062-.015-3.37-4.615c-1.854-2.538-3.37-4.625-3.37-4.637s3.48-11.056,3.5-11.095c.007-.013,2.375,4.694,5.741,11.411l5.774,11.521.044.088-10.711,0-10.711,0Z" style="fill:#0089d6"/><path d="M2.125,24.586c0-.006,1.588-3.18,3.529-7.053l3.529-7.041L13.3,6.52c2.262-2.185,4.119-3.976,4.126-3.979a.914.914,0,0,1-.066.192L12.89,13.759,8.5,24.589l-3.189,0C3.56,24.6,2.125,24.593,2.125,24.586Z" style="fill:#0089d6"/></svg>
                                        <span class="mt-2">Azure DevOps</span>
                                    </span>
                                </label>
                            </div>

                            <!-- Jenkins Card -->
                            <div class="col-md-4">
                                <label class="form-check form-check-inline form-check-card">
                                    <input id="edit-cicd-jenkins" class="form-check-input" type="radio" name="settings[0].ToolType" value="Jenkins">
                                    <span class="form-check-card-content">
                                        <svg width="128" height="128" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg"><title>file_type_jenkins</title><path d="M19.513,25.173c-.068,0-.136,0-.2-.01C19.378,25.169,19.445,25.173,19.513,25.173Z" style="fill:none" /><path d="M18.919,25.087a1.93,1.93,0,0,0,.392.076A1.93,1.93,0,0,1,18.919,25.087Z" style="fill:none" /><path d="M20.091,27.511c-.021-.121-.043-.221-.064-.31h0c.021.089.043.189.064.31Z" style="fill:none" /><path d="M7.436,14.214A.832.832,0,0,1,7.6,14.1.581.581,0,0,0,7.436,14.214Z" style="fill:#f0d6b7" /><path d="M10.412,18.253c.06.421.24,4.164,2.766,6.25a15.465,15.465,0,0,0,1.549.162c.28-.6,1.312-.554,1.985-.4a6.648,6.648,0,0,1-2.176-1.778,4.466,4.466,0,0,1-1.472-2.656c1.348,1.87,2.462,3.5,4.913,4.326,1.855.622,4.021-.285,5.446-1.286a6.258,6.258,0,0,0,1.365-1.68,14.242,14.242,0,0,0,2.145-8.621,9.567,9.567,0,0,0-.5-3.446c-.453-.908-1.984-1.72-2.88-.9a1.07,1.07,0,0,1-.016-.246c-.143.134-.23.232-.23.232a1.209,1.209,0,0,1-.122-.487,1.551,1.551,0,0,1,1.5-1.5,8.674,8.674,0,0,0-1.479-1.563,10.49,10.49,0,0,0-6.047-.222,8.06,8.06,0,0,0-5.975,5.4,14.085,14.085,0,0,0-.388,2.263c-.031.884.416,1.655.45,2.617-.239.394-.969.443-1.474.416-.037-.187-.082-.379-.136-.566a5.158,5.158,0,0,0-1.265-.5,1.719,1.719,0,0,1,1.009,2.038c-.373-.213-.462-1.15-.9-1.177-.626-.038-.512,1.216-.509,1.95a2.291,2.291,0,0,1-.19-2.213c-.284-.139-.444.061-.6.217-.222,1.036-.547,1.873.062,2.92a1.734,1.734,0,0,0,1.414.6c.567-.056.706-.624,1.324-.618A.513.513,0,0,1,10.412,18.253ZM16.861,20.2l-.3-.061s-.314-1.1-.163-1.306c.08-.107.52-.268,1.136.028C17.53,18.862,16.8,18.984,16.861,20.2Zm5.706,1.341a5.27,5.27,0,0,1-3.426-.014A4.687,4.687,0,0,1,17.858,20.1c-.155-.2-.927-.708-.012-.709h0c.717,1.8,3.18,1.592,5.257,1.543A1.111,1.111,0,0,1,22.567,21.542Zm.3-1.6a4.016,4.016,0,0,1,0-1.063,8.538,8.538,0,0,0,2.96-1.185h0A3.425,3.425,0,0,1,22.866,19.939Zm2.756-8.073c-.183.061-1.37.762-1.278-.122a1.348,1.348,0,0,1,1.026-1.077,3.037,3.037,0,0,1,0-.4h0l.079,0a17.146,17.146,0,0,0,1.172,2.29c-.317.738-2.4,1.39-2.366.066.45-.2,1.227-.04,1.626-.291-.094-.257-.2-.5-.3-.756Zm-5.187,4.75a.719.719,0,0,1,.046.1c.091-.507.259-1.1.548-1.013a.684.684,0,0,1,.5.638,6.908,6.908,0,0,0-.948.738c.065.3.144.6.523.668,1.106.189,2.393-.677,3.189-.979.493-.832-.043-1.138-.487-1.673-.91-1.1-2.13-2.456-2.086-4.1.368-.267.4.407.452.53a15.006,15.006,0,0,0,2.543,3.486c.214.234.567.459.606.614.113.451-.294.991-.247,1.29h0a6.587,6.587,0,0,1-4.466,1.4A1.322,1.322,0,0,1,20.434,16.615Zm1.958,2.321A4.933,4.933,0,0,1,22.47,20c-1.811.09-3.952-.358-4.427-1.629A10.285,10.285,0,0,0,22.393,18.936Zm-4.256-8.648a6.954,6.954,0,0,0,.977,1.829c.228.222.67.492.451,1.109a1.406,1.406,0,0,1-.642.534c-.79.233-2.631.048-2.008-.937.653.03,1.532.424,2.02-.05-.095-.152-.209-.341-.322-.551-.5.316-1.874.33-1.874-.479,0-.852,1.339-1.034,1.339-1.034l.01.024A1.11,1.11,0,0,1,18.137,10.288ZM14.914,7.363c1.195-.815,1.8-.35,2.1.188a.568.568,0,0,1,.274.828c-1.658-.386-2.482.694-2.985,1.814-.129.234-.136.068-.21-.136a.392.392,0,0,1-.061-.136A.551.551,0,0,0,13.94,9.8C13.7,9.553,13.575,8.276,14.914,7.363Z" style="fill:#f0d6b7" /><path d="M6.283,29.28h8.753c-.04-.135-.079-.268-.118-.394a12.164,12.164,0,0,1-.476-1.948,21.079,21.079,0,0,1-3.087-1.655,2.353,2.353,0,0,1-.24-.257L5.849,27.379S6.038,28.133,6.283,29.28Z" style="fill:#335061" /><path d="M9.433,7A2.125,2.125,0,0,1,9.9,6.912a3.817,3.817,0,0,0,.747.029c.494-.123.912-1.231,1.285-1.644a11.333,11.333,0,0,1,.941-.776A7.346,7.346,0,0,0,9.433,7Z" style="fill:#6d6b6d" /><path d="M7.177,12.586a2.147,2.147,0,0,1,3.145,1.747c.694-.018.259-.866.134-1.413-.369-1.608.487-3.34.192-4.861C6.782,8.637,7,11.606,7.177,12.586Z" style="fill:#6d6b6d" /><path d="M13.249,3.851c-1.82.516-4.152,1.838-4.9,3.473A7.389,7.389,0,0,0,9.433,7a7.346,7.346,0,0,1,3.44-2.479,1.647,1.647,0,0,0,.159-.166c.192-.093.476-.086.487-.375C13.436,3.891,13.348,3.823,13.249,3.851Z" style="fill:#dcd9d8" /><path d="M7.5,8.985c-.8.885-.636,2.542-.538,3.721a2.321,2.321,0,0,1,.218-.12c-.18-.979-.394-3.949,3.471-4.527a2.81,2.81,0,0,0-.142-.493A4.409,4.409,0,0,0,7.5,8.985Z" style="fill:#dcd9d8" /><path d="M10.412,18.253a.513.513,0,0,0-.42-.468c.335.668-.516.878-.6,1.355a3.837,3.837,0,0,0,.125.832,11.351,11.351,0,0,0,1.445,3.365,3.181,3.181,0,0,0,2.22,1.166C10.652,22.418,10.472,18.674,10.412,18.253Z" style="fill:#f7e4cd" /><path d="M21.525,16.338a.684.684,0,0,0-.5-.638c-.289-.082-.457.506-.548,1.013a2.376,2.376,0,0,1,.1.363A6.908,6.908,0,0,1,21.525,16.338Z" style="fill:#f7e4cd" /><path d="M24.344,11.744c-.092.884,1.1.183,1.278.122l-.043-.286a3.235,3.235,0,0,1-.209-.913A1.348,1.348,0,0,0,24.344,11.744Z" style="fill:#f7e4cd" /><path d="M16.739,11.744c0,.809,1.371.795,1.874.479a4.053,4.053,0,0,1-.525-1.489l-.01-.024S16.739,10.892,16.739,11.744Z" style="fill:#f7e4cd" /><path d="M7.192,14.885a.8.8,0,0,1-.125.109,1.221,1.221,0,0,1,.37-.781A.581.581,0,0,1,7.6,14.1a.979.979,0,0,1,.782-.032,5.158,5.158,0,0,1,1.265.5c-.193-.664-.524-1.263-1.208-1.338a2.034,2.034,0,0,0-2.2,1.963A3.858,3.858,0,0,0,7.254,17.8C6.644,16.758,6.97,15.921,7.192,14.885Z" style="fill:#f7e4cd" /><path d="M17.165,4.443a10.49,10.49,0,0,1,6.047.222,4.127,4.127,0,0,0-.49-.329c-1.889-1.066-5.086-1.867-7.1-.866-1.621.808-3.813,2.146-4.56,3.841a4.109,4.109,0,0,1,.123,2.532A8.06,8.06,0,0,1,17.165,4.443Z" style="fill:#f7e4cd" /><path d="M23.188,7.728a1.209,1.209,0,0,0,.122.487s.087-.1.23-.232c.031-.734.865-1.152,1.832-.866-.222-.286-.447-.589-.681-.889A1.551,1.551,0,0,0,23.188,7.728Z" style="fill:#f7e4cd" /><path d="M14.092,10.058c.074.2.082.37.21.136A.348.348,0,0,1,14.092,10.058Z" style="fill:#f7e4cd" /><path d="M14.032,9.922a1.486,1.486,0,0,1,.114-.758,2.816,2.816,0,0,1,2.47-1.755,1.149,1.149,0,0,1,.4.143c-.3-.538-.9-1-2.1-.188-1.338.913-1.217,2.19-.973,2.434A.551.551,0,0,1,14.032,9.922Z" style="fill:#f7e4cd" /><path d="M5.849,27.379l5.266-2.353c-.386-.448-1.079-1.3-1.2-1.257a24.079,24.079,0,0,0-5.61,3.485,20.236,20.236,0,0,1,.81,2.026H6.283C6.038,28.133,5.849,27.379,5.849,27.379Z" style="fill:#49728b" /><path d="M27,29.307a20.836,20.836,0,0,0,.548-2.058c.036-.181.106-.475.156-.756l-2.886-2.144a5.123,5.123,0,0,1,.13,3.9c.1.372.454.515.6.85-.034.06-.068.119-.1.179h1.476A.149.149,0,0,1,27,29.307Z" style="fill:#335061" /><path d="M24.441,28.074a1.081,1.081,0,0,0,.172-.381,1.081,1.081,0,0,1-.172.381Z" style="fill:#335061" /><path d="M23.617,23.946a.948.948,0,0,1,.514-.106l-.238-.177A1.457,1.457,0,0,0,23.617,23.946Z" style="fill:#335061" /><path d="M27.756,25.879c-.074-.537-.8-.935-1.172-1.266C25.9,24,25.472,23.46,24.761,22.887a4.391,4.391,0,0,1-.869.776l.238.177a.932.932,0,0,1,.686.51L27.7,26.493A2.339,2.339,0,0,0,27.756,25.879Z" style="fill:#49728b" /><path d="M20.572,29.2a.438.438,0,0,0,.009.076h.479a.333.333,0,0,1,.666,0H22.5v-.03c-.274-.144-.873-.455-1.2-.593C20.876,28.475,20.572,29.2,20.572,29.2Z" style="fill:#fff" /><path d="M20.572,29.2s.3-.73.73-.548c.322.138.921.449,1.2.593.01-.22.02-.44.034-.66-.618.039-.961-.559-1.394-.605-.378-.041-.7.435-1.19.229-.113.124-.215.259-.33.381a6.313,6.313,0,0,1,.489.685h.476A.438.438,0,0,1,20.572,29.2Z" style="fill:#dcd9d8" /><path d="M14.511,25.169a6.738,6.738,0,0,1-2.269-.4.282.282,0,0,0,.017.421,7.657,7.657,0,0,0,2.14.578A1.748,1.748,0,0,0,14.511,25.169Z" style="fill:#fff" /><path d="M14.357,26.069a1.233,1.233,0,0,1,.041-.3,7.657,7.657,0,0,1-2.14-.578A4.237,4.237,0,0,0,14.357,26.069Z" style="fill:#dcd9d8" /><path d="M24.613,27.693a2.963,2.963,0,0,0,.073-.87,7.057,7.057,0,0,0-.2-1.378,3,3,0,0,0-1.009.049c-.3.061-.609.122-.669.487s.122.548-.061.852-.487.122-.791.3c-.207.124-.076.445.029.638a12.138,12.138,0,0,0,2.459.3A1.081,1.081,0,0,0,24.613,27.693Z" style="fill:#d33833" /><path d="M15.562,29.219c.016.043.033.088.047.128s.029.093.042.139l-.009-.117Z" style="fill:#d33833" /><path d="M19.563,27.925q.01-.264.021-.527a1.309,1.309,0,0,1-.96-.074c-.937-.511-.05-.36-.382-1.038a3.236,3.236,0,0,0-1.224-.365c-1.228,0-1.7-.247-1.568,1.169.069.76.131,1.519.191,2.28.1.188.19.357.262.5a4.834,4.834,0,0,0,1.833-.559A21.007,21.007,0,0,0,19.563,27.925Z" style="fill:#d33833" /><path d="M20.027,27.2c.021.089.043.189.064.31h0a.7.7,0,1,0,.428-1.31A.953.953,0,0,1,20.027,27.2Z" style="fill:#d33833" /><path d="M21.953,27.137c.3-.183.609,0,.791-.3s0-.487.061-.852.365-.426.669-.487a3,3,0,0,1,1.009-.049,1.125,1.125,0,0,0-.348-.652c-.747-.436-2.056.825-2.665,1.093l-.057.023a1.694,1.694,0,0,1,.175.558A1.475,1.475,0,0,1,22,26.429a1.761,1.761,0,0,1,.276.033c.045.009.089.02.133.032a1.463,1.463,0,0,1,.243.092,4.209,4.209,0,0,0-.757.1.7.7,0,0,0-.2.095,8.618,8.618,0,0,0-.035.9q.158.045.322.084C21.877,27.582,21.746,27.261,21.953,27.137Z" style="fill:#ef3d3a" /><path d="M15.651,29.485c.051.183.095.348.253.385-.072-.144-.163-.313-.262-.5Z" style="fill:#ef3d3a" /><path d="M15.45,27.089c-.129-1.416.34-1.169,1.568-1.169a3.236,3.236,0,0,1,1.224.365c.332.678-.555.527.382,1.038a1.309,1.309,0,0,0,.96.074l0-.063a3.039,3.039,0,0,0-.916-.29,3.5,3.5,0,0,0-.371-.036,1.555,1.555,0,0,1,.291-.106,3.285,3.285,0,0,0,.906-.281c0-.079.006-.158.009-.236a1.883,1.883,0,0,1-.2-.027,1.565,1.565,0,0,1-.177-.044,1.585,1.585,0,0,1-.294-.127c-.178-.1-.331-.216-.525-.322a9.077,9.077,0,0,0-2.408-.881c-.921-.176-.929,1.105-.89,2.049,0,.1.008.192.013.28a6.585,6.585,0,0,0,.544,1.9l.079.15C15.582,28.609,15.519,27.849,15.45,27.089Z" style="fill:#ef3d3a" /><path d="M20.52,26.2a1.009,1.009,0,0,0-.582.2,1.7,1.7,0,0,0,.007.412c.011.079.028.155.048.238l.031.131,0,.017h0A.953.953,0,0,0,20.52,26.2Z" style="fill:#ef3d3a" /><path d="M14.146,9.164a1.486,1.486,0,0,0-.114.758.392.392,0,0,0,.061.136.348.348,0,0,0,.21.136c.5-1.12,1.327-2.2,2.985-1.814a.568.568,0,0,0-.274-.828,1.149,1.149,0,0,0-.4-.143A2.816,2.816,0,0,0,14.146,9.164Z" style="fill:#231f20" /><path d="M24.252,12.627c-.032,1.324,2.049.672,2.366-.066a17.146,17.146,0,0,1-1.172-2.29l-.079,0h0a3.037,3.037,0,0,0,0,.4,3.235,3.235,0,0,0,.209.913c.095.256.205.5.3.756C25.479,12.587,24.7,12.43,24.252,12.627Z" style="fill:#231f20" /><path d="M18.934,12.773c-.488.474-1.367.08-2.02.05-.623.985,1.218,1.17,2.008.937a1.406,1.406,0,0,0,.642-.534c.219-.617-.223-.887-.451-1.109a6.954,6.954,0,0,1-.977-1.829,1.11,1.11,0,0,0-.049.445,4.053,4.053,0,0,0,.525,1.489C18.726,12.432,18.839,12.621,18.934,12.773Z" style="fill:#231f20" /><path d="M20.605,18.315a6.587,6.587,0,0,0,4.466-1.4h0c-.047-.3.36-.84.247-1.29-.039-.155-.392-.38-.606-.614a15.006,15.006,0,0,1-2.543-3.486c-.053-.123-.085-.8-.452-.53-.044,1.642,1.176,3,2.086,4.1.444.535.98.841.487,1.673-.8.3-2.083,1.169-3.189.979-.379-.065-.458-.365-.523-.668a2.376,2.376,0,0,0-.1-.363.719.719,0,0,0-.046-.1A1.322,1.322,0,0,0,20.605,18.315Z" style="fill:#231f20" /><path d="M7.6,14.1a.832.832,0,0,0-.159.111,1.221,1.221,0,0,0-.37.781.8.8,0,0,0,.125-.109c.153-.156.313-.357.6-.217a2.291,2.291,0,0,0,.19,2.213c0-.733-.117-1.987.509-1.95.438.027.527.964.9,1.177A1.719,1.719,0,0,0,8.378,14.07.979.979,0,0,0,7.6,14.1Z" style="fill:#231f20" /><path d="M22.868,18.875a4.016,4.016,0,0,0,0,1.063,3.425,3.425,0,0,0,2.962-2.249h0A8.538,8.538,0,0,1,22.868,18.875Z" style="fill:#231f20" /><path d="M22.47,20a4.933,4.933,0,0,0-.077-1.066,10.285,10.285,0,0,1-4.35-.562C18.518,19.644,20.659,20.092,22.47,20Z" style="fill:#231f20" /><path d="M17.846,19.39h0c-.915,0-.143.51.012.709a4.687,4.687,0,0,0,1.284,1.428,5.27,5.27,0,0,0,3.426.014,1.111,1.111,0,0,0,.536-.609C21.026,20.982,18.563,21.189,17.846,19.39Z" style="fill:#231f20" /><path d="M24.96,29.28a1.709,1.709,0,0,0-1.042-.753,1.433,1.433,0,0,0-.918.12c-.008.2-.018.415-.031.632Z" style="fill:#81b0c4" /><path d="M21.971,24.749c-.686.061-1.493.373-2.252.419-.069,0-.138.006-.206.006s-.136,0-.2-.01a1.93,1.93,0,0,1-.392-.076,1.666,1.666,0,0,1-.188-.07c0,.052-.071.033-.082.076.085.066.167.126.247.179s.159.1.238.143a2.218,2.218,0,0,0,.475.19,3.052,3.052,0,0,0,.816.09c.1,0,.212,0,.327-.009C21.169,25.384,21.537,25.031,21.971,24.749Z" style="fill:#f0d6b7" /><path d="M19.086,29.048l-.351.233h.527Q19.176,29.162,19.086,29.048Z" style="fill:#81b0c4" /><path d="M4.681,29.769v-.335a.153.153,0,0,1,.153-.153h.283a20.236,20.236,0,0,0-.81-2.026,24.079,24.079,0,0,1,5.61-3.485c.118-.047.811.809,1.2,1.257a2.353,2.353,0,0,0,.24.257,21.079,21.079,0,0,0,3.087,1.655,12.164,12.164,0,0,0,.476,1.948c.039.126.078.26.118.394H15.2a.153.153,0,0,1,.153.153v.158h.139a.153.153,0,0,1,.153.153V30h1.691v-.255a.153.153,0,0,1,.153-.153h.78v-.158a.153.153,0,0,1,.153-.153h.317l.351-.233q.09.114.176.233h.843a6.313,6.313,0,0,0-.489-.685c.115-.122.217-.256.33-.381.492.206.812-.27,1.19-.229.433.046.776.644,1.394.605-.014.22-.024.44-.034.66v.03h.474c.012-.217.023-.429.031-.632a1.433,1.433,0,0,1,.918-.12,1.709,1.709,0,0,1,1.042.753h.481c.034-.06.069-.119.1-.179-.143-.335-.495-.477-.6-.85a5.123,5.123,0,0,0-.13-3.9.932.932,0,0,0-.686-.51.948.948,0,0,0-.514.106,1.457,1.457,0,0,1,.275-.283,4.391,4.391,0,0,0,.869-.776c.712.573,1.141,1.112,1.824,1.725.37.332,1.1.73,1.172,1.266a2.339,2.339,0,0,1-.054.614c-.051.281-.12.575-.156.756A20.836,20.836,0,0,1,27,29.307a.15.15,0,0,1,.072.127V30h.368c.258-.808.511-1.635.766-2.489a6.207,6.207,0,0,0,.478-2.187c-.078-.617-1.04-1.265-1.547-1.754-.281-.271-1.593-1.267-1.669-1.64s.535-1.178.731-1.586a11.669,11.669,0,0,0,.621-1.788c1.032-3.627,1.137-8.611-.339-11.592a12.54,12.54,0,0,0-3.1-3.428c-2.3-1.742-6.563-1.935-9.339-.913a13.481,13.481,0,0,0-2.2.939C10.024,4.628,8.094,5.342,7.555,7.49c-1.328.6-1.729,2.3-1.662,4.268a6.221,6.221,0,0,1,.149,1.227c-.037.184-.286.419-.336.538a5.3,5.3,0,0,0,.609,4.592A3.225,3.225,0,0,0,8.468,19.5a4.568,4.568,0,0,0,.447,1.672c.17.373.805,1.043.571,1.519a6.987,6.987,0,0,1-1.495.966c-1.158.695-2,1.12-3.066,1.89-.692.5-1.773.562-1.6,1.71a17.869,17.869,0,0,0,.808,2.513c.025.078.053.155.08.232h.47ZM13.032,4.355a1.647,1.647,0,0,1-.159.166,11.333,11.333,0,0,0-.941.776c-.373.413-.79,1.521-1.285,1.644A3.817,3.817,0,0,1,9.9,6.912,2.125,2.125,0,0,0,9.433,7a7.389,7.389,0,0,1-1.084.325c.748-1.635,3.08-2.957,4.9-3.473.1-.028.188.04.271.129C13.509,4.268,13.224,4.262,13.032,4.355Zm-2.385,3.7c.3,1.521-.561,3.254-.192,4.861.125.546.56,1.394-.134,1.413a2.147,2.147,0,0,0-3.145-1.747,2.321,2.321,0,0,0-.218.12c-.1-1.179-.266-2.836.538-3.721a4.409,4.409,0,0,1,3.009-1.419A2.81,2.81,0,0,1,10.647,8.059ZM7.254,17.8A3.858,3.858,0,0,1,6.232,15.2a2.034,2.034,0,0,1,2.2-1.963c.684.075,1.014.674,1.208,1.338.054.187.1.379.136.566.505.027,1.235-.022,1.474-.416-.034-.962-.481-1.733-.45-2.617a14.085,14.085,0,0,1,.388-2.263,4.109,4.109,0,0,0-.123-2.532c.747-1.695,2.939-3.032,4.56-3.841,2.009-1,5.207-.2,7.1.866a4.127,4.127,0,0,1,.49.329,8.674,8.674,0,0,1,1.479,1.563c.234.3.459.6.681.889-.967-.287-1.8.132-1.832.866a1.07,1.07,0,0,0,.016.246c.9-.821,2.427-.009,2.88.9a9.567,9.567,0,0,1,.5,3.446,14.242,14.242,0,0,1-2.145,8.621,6.258,6.258,0,0,1-1.365,1.68c-1.425,1-3.591,1.908-5.446,1.286-2.451-.823-3.565-2.456-4.913-4.326a4.466,4.466,0,0,0,1.472,2.656,6.648,6.648,0,0,0,2.176,1.778c-.673-.158-1.7-.208-1.985.4a15.465,15.465,0,0,1-1.549-.162,3.181,3.181,0,0,1-2.22-1.166,11.351,11.351,0,0,1-1.445-3.365,3.837,3.837,0,0,1-.125-.832c.088-.478.939-.687.6-1.355-.618-.006-.757.562-1.324.618A1.734,1.734,0,0,1,7.254,17.8Zm12.77,9.38-.031-.131c-.02-.083-.036-.159-.048-.238a1.7,1.7,0,0,1-.007-.412,1.009,1.009,0,0,1,.582-.2.7.7,0,1,1-.428,1.31c-.021-.121-.043-.221-.064-.31Zm-7.782-2.419a6.738,6.738,0,0,0,2.269.4,1.748,1.748,0,0,1-.112.6,1.233,1.233,0,0,0-.041.3,4.237,4.237,0,0,1-2.1-.882A.282.282,0,0,1,12.242,24.766Zm7.367.839a2.218,2.218,0,0,1-.475-.19c-.078-.042-.157-.09-.238-.143s-.162-.113-.247-.179c.011-.043.079-.024.082-.076a1.666,1.666,0,0,0,.188.07,1.93,1.93,0,0,0,.392.076c.067.006.134.009.2.01s.137,0,.206-.006c.759-.046,1.566-.358,2.252-.419-.433.283-.8.636-1.218.938-.115.006-.224.009-.327.009A3.052,3.052,0,0,1,19.609,25.605Zm-1.872,3.706a4.834,4.834,0,0,1-1.833.559c-.158-.037-.2-.2-.253-.385-.013-.046-.026-.092-.042-.139s-.03-.085-.047-.128a6.585,6.585,0,0,1-.544-1.9c0-.088-.009-.182-.013-.28-.039-.944-.031-2.225.89-2.049a9.077,9.077,0,0,1,2.408.881c.194.106.347.225.525.322a1.585,1.585,0,0,0,.294.127,1.565,1.565,0,0,0,.177.044,1.883,1.883,0,0,0,.2.027c0,.078-.006.157-.009.236a3.285,3.285,0,0,1-.906.281,1.555,1.555,0,0,0-.291.106,3.5,3.5,0,0,1,.371.036,3.039,3.039,0,0,1,.916.29l0,.063q-.01.264-.021.527A21.007,21.007,0,0,1,17.737,29.311Zm4.245-1.536q-.164-.039-.322-.084a8.618,8.618,0,0,1,.035-.9.7.7,0,0,1,.2-.095,4.209,4.209,0,0,1,.757-.1,1.463,1.463,0,0,0-.243-.092c-.043-.012-.088-.023-.133-.032A1.761,1.761,0,0,0,22,26.429a1.475,1.475,0,0,0-.407.038,1.694,1.694,0,0,0-.175-.558l.057-.023c.609-.268,1.918-1.529,2.665-1.093a1.125,1.125,0,0,1,.348.652,7.057,7.057,0,0,1,.2,1.378,2.963,2.963,0,0,1-.073.87,1.081,1.081,0,0,1-.172.381h0A12.138,12.138,0,0,1,21.982,27.774Z" style="fill:#231f20" /><path d="M17.53,18.862c-.616-.3-1.056-.135-1.136-.028-.152.2.163,1.306.163,1.306l.3.061C16.8,18.984,17.53,18.862,17.53,18.862Z" style="fill:#f7e4cd" /><path d="M21.393,28.961a.334.334,0,0,0-.333.319h.666A.334.334,0,0,0,21.393,28.961Z" style="fill:#1d1919" /><path d="M15.642,29.745a.153.153,0,0,0-.153-.153h-.139v.177a.153.153,0,0,1-.153.153H4.834a.153.153,0,0,1-.153-.153V30H15.642Z" style="fill:#231f20" /><path d="M26.918,29.922h-8.5a.153.153,0,0,1-.153-.153v-.177h-.78a.153.153,0,0,0-.153.153V30h9.737v-.231A.153.153,0,0,1,26.918,29.922Z" style="fill:#231f20" /><path d="M4.834,29.922H15.2a.153.153,0,0,0,.153-.153v-.335a.153.153,0,0,0-.153-.153H4.834a.153.153,0,0,0-.153.153v.335A.153.153,0,0,0,4.834,29.922Z" style="fill:#231f20" /><path d="M18.266,29.769a.153.153,0,0,0,.153.153h8.5a.153.153,0,0,0,.153-.153v-.335A.15.15,0,0,0,27,29.307a.149.149,0,0,0-.081-.026h-8.5a.153.153,0,0,0-.153.153v.335Z" style="fill:#231f20" /></svg>
                                        <span class="mt-2">Jenkins</span>
                                    </span>
                                </label>
                            </div>

                            <!-- GitLab Card -->
                            <div class="col-md-4">
                                <label class="form-check form-check-inline form-check-card">
                                    <input id="edit-cicd-gitlab" class="form-check-input" type="radio" name="settings[0].ToolType" value="GitLab">
                                    <span class="form-check-card-content">
                                        <svg width="128" height="128" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg" fill="none"><path fill="#FC6D26" d="M14.975 8.904L14.19 6.55l-1.552-4.67a.268.268 0 00-.255-.18.268.268 0 00-.254.18l-1.552 4.667H5.422L3.87 1.879a.267.267 0 00-.254-.179.267.267 0 00-.254.18l-1.55 4.667-.784 2.357a.515.515 0 00.193.583l6.78 4.812 6.778-4.812a.516.516 0 00.196-.583z"/><path fill="#E24329" d="M8 14.296l2.578-7.75H5.423L8 14.296z"/><path fill="#FC6D26" d="M8 14.296l-2.579-7.75H1.813L8 14.296z"/><path fill="#FCA326" d="M1.81 6.549l-.784 2.354a.515.515 0 00.193.583L8 14.3 1.81 6.55z"/><path fill="#E24329" d="M1.812 6.549h3.612L3.87 1.882a.268.268 0 00-.254-.18.268.268 0 00-.255.18L1.812 6.549z"/><path fill="#FC6D26" d="M8 14.296l2.578-7.75h3.614L8 14.296z"/><path fill="#FCA326" d="M14.19 6.549l.783 2.354a.514.514 0 01-.193.583L8 14.296l6.188-7.747h.001z"/><path fill="#E24329" d="M14.19 6.549H10.58l1.551-4.667a.267.267 0 01.255-.18c.115 0 .217.073.254.18l1.552 4.667z"/></svg>
                                        <span class="mt-2">GitLab</span>
                                    </span>
                                </label>
                            </div>
                        </div>
                    </div>

                    <!-- Common Fields -->
                    <div class="row g-3">
                        <div class="col-md-12">
                            <label class="form-label required">Configuration Name</label>
                            <input id="edit-cicd-name" type="text" class="form-control" name="settings[0].Name" placeholder="e.g. Production Pipeline" required>
                        </div>

                        <div class="col-md-12">
                            <label class="form-label required">API URL</label>
                            <input id="edit-cicd-apiurl" type="url" class="form-control" name="settings[0].ApiUrl" placeholder="https://api.example.com" required>
                        </div>

                        <div class="col-md-12">
                            <label class="form-label required">Access Token</label>
                            <div class="input-group">
                                <input id="edit-cicd-accesstoken" type="password" class="form-control" name="settings[0].AccessToken" placeholder="Your access token" required>
                                <button class="btn btn-outline-secondary" type="button" id="toggleEditTokenVisibility">
                                    <svg xmlns="http://www.w3.org/2000/svg" class="icon" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
                                        <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
                                        <path d="M10 12a2 2 0 1 0 4 0a2 2 0 0 0 -4 0"></path>
                                        <path d="M21 12c-2.4 4 -5.4 6 -9 6c-3.6 0 -6.6 -2 -9 -6c2.4 -4 5.4 -6 9 -6c3.6 0 6.6 2 9 6"></path>
                                    </svg>
                                </button>
                            </div>
                        </div>
                    </div>

                    <!-- Azure DevOps Specific Fields -->
                    <div id="edit-azure-fields" class="cicd-provider-fields">
                        <div class="row g-3 mt-3">
                            <div class="col-md-6">
                                <label class="form-label required">Organization</label>
                                <input id="edit-cicd-organization" type="text" class="form-control" name="settings[0].Organization" placeholder="your-organization">
                            </div>

                            <div class="col-md-6">
                                <label class="form-label required">Project</label>
                                <input id="edit-cicd-project" type="text" class="form-control" name="settings[0].Project" placeholder="your-project">
                            </div>

                            <div class="col-md-6">
                                <label class="form-label">Collection Name</label>
                                <input id="edit-cicd-collectionname" type="text" class="form-control" name="settings[0].CollectionName" placeholder="DefaultCollection">
                            </div>
                        </div>
                    </div>

                    <!-- Jenkins Specific Fields -->
                    <div id="edit-jenkins-fields" class="cicd-provider-fields d-none">
                        <div class="row g-3 mt-3">
                            <div class="col-md-6">
                                <label class="form-label required">Job Name</label>
                                <input id="edit-cicd-jobname" type="text" class="form-control" name="settings[0].JobName" placeholder="your-job-name">
                            </div>

                            <div class="col-md-6">
                                <label class="form-label">Jenkins Username</label>
                                <input id="edit-cicd-jenkinsusername" type="text" class="form-control" name="settings[0].JenkinsUsername" placeholder="jenkins-user">
                            </div>

                            <div class="col-md-6">
                                <label class="form-label">Crumb</label>
                                <input id="edit-cicd-crumb" type="text" class="form-control" name="settings[0].Crumb" placeholder="Jenkins crumb">
                            </div>
                        </div>
                    </div>

                    <!-- GitLab Specific Fields -->
                    <div id="edit-gitlab-fields" class="cicd-provider-fields d-none">
                        <div class="row g-3 mt-3">
                            <div class="col-md-6">
                                <label class="form-label">Group ID</label>
                                <input id="edit-cicd-groupid" type="text" class="form-control" name="settings[0].GroupId" placeholder="12345">
                            </div>

                            <div class="col-md-6">
                                <label class="form-label">Project ID</label>
                                <input id="edit-cicd-projectid" type="text" class="form-control" name="settings[0].ProjectId" placeholder="67890">
                            </div>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-link link-secondary" data-bs-dismiss="modal">
                        Cancel
                    </button>
                    <button type="submit" class="btn btn-primary ms-auto">
                        Save Setting
                    </button>
                </div>
            </form>
        </div>
    </div>
</div>

<!-- Delete CI/CD Settings Modal -->
<div class="modal modal-blur fade" id="delete-cicd-modal" tabindex="-1" role="dialog" aria-hidden="true">
    <div class="modal-dialog modal-sm modal-dialog-centered" role="document">
        <div class="modal-content">
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            <div class="modal-status bg-danger"></div>
            <div class="modal-body text-center py-4">
                <svg xmlns="http://www.w3.org/2000/svg" class="icon mb-2 text-danger icon-lg" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
                    <path stroke="none" d="M0 0h24v24H0z" fill="none" />
                    <path d="M12 9v4" />
                    <path d="M10.363 3.591l-8.106 13.534a1.914 1.914 0 0 0 1.636 2.871h16.214a1.914 1.914 0 0 0 1.636 -2.87l-8.106 -13.536a1.914 1.914 0 0 0 -3.274 0z" />
                    <path d="M12 16h.01" />
                </svg>
                <h3>Are you sure?</h3>
                <div class="text-muted">Do you really want to delete this CI/CD settings? This action cannot be undone.</div>
                <form id="delete-cicd-form" method="post"
                      asp-action="DeleteCICDSettings" asp-controller="SiteSettings"
                      data-ajax="true" data-ajax-method="DELETE">
                    <input type="hidden" id="delete-cicd-id" name="id" value="" />
                    <div class="modal-footer">
                        <button type="button" class="btn btn-link link-secondary" data-bs-dismiss="modal">Cancel</button>
                        <button type="submit" class="btn btn-danger ms-auto">Delete</button>
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>

<!-- Add Mail Settings Modal -->
<div class="modal modal-blur fade" id="add-mail-modal" tabindex="-1" role="dialog" aria-hidden="true">
    <div class="modal-dialog modal-lg modal-dialog-centered" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">Add Mail Settings</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <form id="add-mail-form" method="post" asp-action="CreateMailSettings">
                <div class="modal-body">
                    <div class="row mb-3">
                        <div class="col-lg-12">
                            <label class="form-label required">Mail Provider</label>
                            <select name="settings[0].Provider" class="form-select" id="mail-provider-select">
                                <option value="">Select a provider</option>
                                <option value="SMTP">SMTP</option>
                                <option value="SendGrid">SendGrid</option>
                                <option value="Azure">Azure Communication Services</option>
                            </select>
                        </div>
                    </div>

                    <div class="row mb-3">
                        <div class="col-lg-12">
                            <label class="form-label required">Configuration Name</label>
                            <input type="text" class="form-control" name="settings[0].Name" placeholder="e.g. Production Mail" required>
                        </div>
                    </div>

                    <!-- SMTP Fields -->
                    <div id="smtp-fields" class="mail-provider-fields" style="display: none;">
                        <div class="row mb-3">
                            <div class="col-lg-12">
                                <label class="form-label required">SMTP Host</label>
                                <input type="text" class="form-control" name="settings[0].SmtpHost" placeholder="smtp.example.com">
                            </div>
                        </div>
                        <div class="row mb-3">
                            <div class="col-lg-12">
                                <label class="form-label required">SMTP Port</label>
                                <input type="number" class="form-control" name="settings[0].SmtpPort" placeholder="587">
                            </div>
                        </div>
                        <div class="row mb-3">
                            <div class="col-lg-12">
                                <label class="form-label">SMTP Username</label>
                                <input type="text" class="form-control" name="settings[0].SmtpUsername" placeholder="username">
                            </div>
                        </div>
                        <div class="row mb-3">
                            <div class="col-lg-12">
                                <label class="form-label">SMTP Password</label>
                                <div class="input-group">
                                    <input type="password" class="form-control" name="settings[0].SmtpPassword" placeholder="password">
                                    <button class="btn btn-outline-secondary" type="button" id="toggleSmtpPassword">
                                        <svg xmlns="http://www.w3.org/2000/svg" class="icon" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
                                            <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
                                            <path d="M10 12a2 2 0 1 0 4 0a2 2 0 0 0 -4 0"></path>
                                            <path d="M21 12c-2.4 4 -5.4 6 -9 6c-3.6 0 -6.6 -2 -9 -6c2.4 -4 5.4 -6 9 -6c3.6 0 6.6 2 9 6"></path>
                                        </svg>
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- SendGrid Fields -->
                    <div id="sendgrid-fields" class="mail-provider-fields" style="display: none;">
                        <div class="row mb-3">
                            <div class="col-lg-12">
                                <label class="form-label required">SendGrid API Key</label>
                                <div class="input-group">
                                    <input type="password" class="form-control" name="settings[0].SendGridApiKey" placeholder="SG.xxxxxxxx">
                                    <button class="btn btn-outline-secondary" type="button" id="toggleSendGridKey">
                                        <svg xmlns="http://www.w3.org/2000/svg" class="icon" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
                                            <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
                                            <path d="M10 12a2 2 0 1 0 4 0a2 2 0 0 0 -4 0"></path>
                                            <path d="M21 12c-2.4 4 -5.4 6 -9 6c-3.6 0 -6.6 -2 -9 -6c2.4 -4 5.4 -6 9 -6c3.6 0 6.6 2 9 6"></path>
                                        </svg>
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Azure Fields -->
                    <div id="azure-fields" class="mail-provider-fields" style="display: none;">
                        <div class="row mb-3">
                            <div class="col-lg-12">
                                <label class="form-label required">Azure Tenant ID</label>
                                <input type="text" class="form-control" name="settings[0].AzureTenantId" placeholder="xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx">
                            </div>
                        </div>
                        <div class="row mb-3">
                            <div class="col-lg-12">
                                <label class="form-label required">Azure Client ID</label>
                                <input type="text" class="form-control" name="settings[0].AzureClientId" placeholder="xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx">
                            </div>
                        </div>
                        <div class="row mb-3">
                            <div class="col-lg-12">
                                <label class="form-label required">Azure Client Secret</label>
                                <div class="input-group">
                                    <input type="password" class="form-control" name="settings[0].AzureClientSecret" placeholder="xxxxxxxxxxxxxxxxxxxx">
                                    <button class="btn btn-outline-secondary" type="button" id="toggleAzureSecret">
                                        <svg xmlns="http://www.w3.org/2000/svg" class="icon" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
                                            <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
                                            <path d="M10 12a2 2 0 1 0 4 0a2 2 0 0 0 -4 0"></path>
                                            <path d="M21 12c-2.4 4 -5.4 6 -9 6c-3.6 0 -6.6 -2 -9 -6c2.4 -4 5.4 -6 9 -6c3.6 0 6.6 2 9 6"></path>
                                        </svg>
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-link link-secondary" data-bs-dismiss="modal">
                        Cancel
                    </button>
                    <button type="submit" class="btn btn-primary ms-auto">
                        <svg xmlns="http://www.w3.org/2000/svg" class="icon" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
                            <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
                            <path d="M12 5l0 14"></path>
                            <path d="M5 12l14 0"></path>
                        </svg>
                        Save Settings
                    </button>
                </div>
            </form>
        </div>
    </div>
</div>

<!-- Edit Mail Settings Modal -->
<div class="modal modal-blur fade" id="edit-mail-modal" tabindex="-1" role="dialog" aria-hidden="true">
    <div class="modal-dialog modal-lg modal-dialog-centered" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">Edit Mail Settings</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <form id="edit-mail-form" method="post" asp-action="UpdateMailSettings">
                <div class="modal-body">
                    <input type="hidden" name="Id" id="edit-mail-id" value="">

                    <div class="row mb-3">
                        <div class="col-lg-12">
                            <label class="form-label required">Mail Provider</label>
                            <select name="settings[0].Provider" class="form-select" id="edit-mail-provider-select">
                                <option value="">Select a provider</option>
                                <option value="SMTP">SMTP</option>
                                <option value="SendGrid">SendGrid</option>
                                <option value="Azure">Azure Communication Services</option>
                            </select>
                        </div>
                    </div>

                    <div class="row mb-3">
                        <div class="col-lg-12">
                            <label class="form-label required">Configuration Name</label>
                            <input type="text" class="form-control" name="settings[0].Name" id="edit-mail-name" placeholder="e.g. Production Mail" required>
                        </div>
                    </div>

                    <!-- SMTP Fields -->
                    <div id="edit-smtp-fields" class="mail-provider-fields" style="display: none;">
                        <div class="row mb-3">
                            <div class="col-lg-12">
                                <label class="form-label required">SMTP Host</label>
                                <input type="text" class="form-control" name="settings[0].SmtpHost" id="edit-smtp-host" placeholder="smtp.example.com">
                            </div>
                        </div>
                        <div class="row mb-3">
                            <div class="col-lg-12">
                                <label class="form-label required">SMTP Port</label>
                                <input type="number" class="form-control" name="settings[0].SmtpPort" id="edit-smtp-port" placeholder="587">
                            </div>
                        </div>
                        <div class="row mb-3">
                            <div class="col-lg-12">
                                <label class="form-label">SMTP Username</label>
                                <input type="text" class="form-control" name="settings[0].SmtpUsername" id="edit-smtp-username" placeholder="username">
                            </div>
                        </div>
                        <div class="row mb-3">
                            <div class="col-lg-12">
                                <label class="form-label">SMTP Password</label>
                                <div class="input-group">
                                    <input type="password" class="form-control" name="settings[0].SmtpPassword" id="edit-smtp-password" placeholder="password">
                                    <button class="btn btn-outline-secondary" type="button" id="toggleEditSmtpPassword">
                                        <svg xmlns="http://www.w3.org/2000/svg" class="icon" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
                                            <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
                                            <path d="M10 12a2 2 0 1 0 4 0a2 2 0 0 0 -4 0"></path>
                                            <path d="M21 12c-2.4 4 -5.4 6 -9 6c-3.6 0 -6.6 -2 -9 -6c2.4 -4 5.4 -6 9 -6c3.6 0 6.6 2 9 6"></path>
                                        </svg>
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- SendGrid Fields -->
                    <div id="edit-sendgrid-fields" class="mail-provider-fields" style="display: none;">
                        <div class="row mb-3">
                            <div class="col-lg-12">
                                <label class="form-label required">SendGrid API Key</label>
                                <div class="input-group">
                                    <input type="password" class="form-control" name="settings[0].SendGridApiKey" id="edit-sendgrid-key" placeholder="SG.xxxxxxxx">
                                    <button class="btn btn-outline-secondary" type="button" id="toggleEditSendGridKey">
                                        <svg xmlns="http://www.w3.org/2000/svg" class="icon" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
                                            <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
                                            <path d="M10 12a2 2 0 1 0 4 0a2 2 0 0 0 -4 0"></path>
                                            <path d="M21 12c-2.4 4 -5.4 6 -9 6c-3.6 0 -6.6 -2 -9 -6c2.4 -4 5.4 -6 9 -6c3.6 0 6.6 2 9 6"></path>
                                        </svg>
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Azure Fields -->
                    <div id="edit-azure-fields" class="mail-provider-fields" style="display: none;">
                        <div class="row mb-3">
                            <div class="col-lg-12">
                                <label class="form-label required">Azure Tenant ID</label>
                                <input type="text" class="form-control" name="settings[0].AzureTenantId" id="edit-azure-tenant" placeholder="xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx">
                            </div>
                        </div>
                        <div class="row mb-3">
                            <div class="col-lg-12">
                                <label class="form-label required">Azure Client ID</label>
                                <input type="text" class="form-control" name="settings[0].AzureClientId" id="edit-azure-client" placeholder="xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx">
                            </div>
                        </div>
                        <div class="row mb-3">
                            <div class="col-lg-12">
                                <label class="form-label required">Azure Client Secret</label>
                                <div class="input-group">
                                    <input type="password" class="form-control" name="settings[0].AzureClientSecret" id="edit-azure-secret" placeholder="xxxxxxxxxxxxxxxxxxxx">
                                    <button class="btn btn-outline-secondary" type="button" id="toggleEditAzureSecret">
                                        <svg xmlns="http://www.w3.org/2000/svg" class="icon" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
                                            <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
                                            <path d="M10 12a2 2 0 1 0 4 0a2 2 0 0 0 -4 0"></path>
                                            <path d="M21 12c-2.4 4 -5.4 6 -9 6c-3.6 0 -6.6 -2 -9 -6c2.4 -4 5.4 -6 9 -6c3.6 0 6.6 2 9 6"></path>
                                        </svg>
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-link link-secondary" data-bs-dismiss="modal">
                        Cancel
                    </button>
                    <button type="submit" class="btn btn-primary ms-auto">
                        Save Settings
                    </button>
                </div>
            </form>
        </div>
    </div>
</div>

<!-- Delete Mail Settings Modal -->
<div class="modal modal-blur fade" id="delete-mail-modal" tabindex="-1" role="dialog" aria-hidden="true">
    <div class="modal-dialog modal-sm modal-dialog-centered" role="document">
        <div class="modal-content">
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            <div class="modal-status bg-danger"></div>
            <div class="modal-body text-center py-4">
                <svg xmlns="http://www.w3.org/2000/svg" class="icon mb-2 text-danger icon-lg" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
                    <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
                    <path d="M12 9v4"></path>
                    <path d="M10.363 3.591l-8.106 13.534a1.914 1.914 0 0 0 1.636 2.871h16.214a1.914 1.914 0 0 0 1.636 -2.87l-8.106 -13.536a1.914 1.914 0 0 0 -3.274 0z"></path>
                    <path d="M12 16h.01"></path>
                </svg>
                <h3>Are you sure?</h3>
                <div class="text-muted">Do you really want to delete these mail settings? This action cannot be undone.</div>
                <form id="delete-mail-form" method="post" asp-action="DeleteMailSettings">
                    <input type="hidden" id="delete-mail-id" name="id" value="">
                    <div class="modal-footer">
                        <button type="button" class="btn btn-link link-secondary" data-bs-dismiss="modal">Cancel</button>
                        <button type="submit" class="btn btn-danger ms-auto">Delete</button>
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>

@section Scripts {
 
    <script>
        document.addEventListener("DOMContentLoaded", function () {

            // Token visibility toggle (keep existing)
            document.getElementById('toggleAddTokenVisibility')?.addEventListener('click', function() {
                const tokenInput = document.querySelector('input[name="settings[0].AccessToken"]');
                if (tokenInput.type === 'password') {
                    tokenInput.type = 'text';
                    this.innerHTML = `
                        <svg xmlns="http://www.w3.org/2000/svg" class="icon" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
                            <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
                            <path d="M13.875 18.825a10.05 10.05 0 0 1 .875 -.825a10.05 10.05 0 0 0 3.574 -7.31l.26 -.16"></path>
                            <path d="M10 12a2 2 0 1 0 4 0a2 2 0 0 0 -4 0"></path>
                            <path d="M12 18c-3.6 0 -6.6 -2 -9 -6c2.4 -4 5.4 -6 9 -6c1.425 0 2.774 .25 4 .704"></path>
                            <path d="M3 3l18 18"></path>
                        </svg>
                    `;
                } else {
                    tokenInput.type = 'password';
                    this.innerHTML = `
                        <svg xmlns="http://www.w3.org/2000/svg" class="icon" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
                            <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
                            <path d="M10 12a2 2 0 1 0 4 0a2 2 0 0 0 -4 0"></path>
                            <path d="M21 12c-2.4 4 -5.4 6 -9 6c-3.6 0 -6.6 -2 -9 -6c2.4 -4 5.4 -6 9 -6c3.6 0 6.6 2 9 6"></path>
                        </svg>
                    `;
                }
            });

            document.getElementById('toggleEditTokenVisibility')?.addEventListener('click', function() {
                const tokenInput = document.getElementById('edit-cicd-accesstoken');
                if (tokenInput.type === 'password') {
                    tokenInput.type = 'text';
                    this.innerHTML = `
                        <svg xmlns="http://www.w3.org/2000/svg" class="icon" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
                            <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
                            <path d="M13.875 18.825a10.05 10.05 0 0 1 .875 -.825a10.05 10.05 0 0 0 3.574 -7.31l.26 -.16"></path>
                            <path d="M10 12a2 2 0 1 0 4 0a2 2 0 0 0 -4 0"></path>
                            <path d="M12 18c-3.6 0 -6.6 -2 -9 -6c2.4 -4 5.4 -6 9 -6c1.425 0 2.774 .25 4 .704"></path>
                            <path d="M3 3l18 18"></path>
                        </svg>
                    `;
                } else {
                    tokenInput.type = 'password';
                    this.innerHTML = `
                        <svg xmlns="http://www.w3.org/2000/svg" class="icon" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
                            <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
                            <path d="M10 12a2 2 0 1 0 4 0a2 2 0 0 0 -4 0"></path>
                            <path d="M21 12c-2.4 4 -5.4 6 -9 6c-3.6 0 -6.6 -2 -9 -6c2.4 -4 5.4 -6 9 -6c3.6 0 6.6 2 9 6"></path>
                        </svg>
                    `;
                }
            });

            // Tab switching functionality (keep existing)
            const remoteRepoTab = document.getElementById('remote-repo-tab');
            const projectDirTab = document.getElementById('project-dir-tab');
            const cicdSettingsTab = document.getElementById('cicd-settings-tab');
            const mailSettingsTab = document.getElementById('mail-settings-tab');

            const remoteRepoContent = document.getElementById('remote-repo-content');
            const projectDirContent = document.getElementById('project-dir-content');
            const cicdSettingsContent = document.getElementById('cicd-settings-content');
            const mailSettingsContent = document.getElementById('mail-settings-content');

            function switchTab(activeTab, activeContent) {
                [remoteRepoTab, projectDirTab, cicdSettingsTab,mailSettingsTab].forEach(tab => tab.classList.remove('active'));
                activeTab.classList.add('active');

                [remoteRepoContent, projectDirContent, cicdSettingsContent,mailSettingsContent].forEach(content => content.classList.add('d-none'));
                activeContent.classList.remove('d-none');
            }

            remoteRepoTab.addEventListener('click', (e) => { e.preventDefault(); switchTab(remoteRepoTab, remoteRepoContent); });
            projectDirTab.addEventListener('click', (e) => { e.preventDefault(); switchTab(projectDirTab, projectDirContent); });
            cicdSettingsTab.addEventListener('click', (e) => { e.preventDefault(); switchTab(cicdSettingsTab, cicdSettingsContent); });
            mailSettingsTab.addEventListener('click', (e) => { e.preventDefault(); switchTab(mailSettingsTab, mailSettingsContent); });


            function setupRepoTypeSelect(selectId, formPrefix) {
                const repoTypeSelect = document.getElementById(selectId);
                if (repoTypeSelect) {
                    repoTypeSelect.addEventListener('change', function () {
                        const selectedType = this.value.toLowerCase();
                        const modal = this.closest('.modal');
                        modal.querySelectorAll('.repo-form').forEach(form => form.style.display = 'none');
                        const targetForm = document.getElementById(`${formPrefix}-${selectedType}-form`);
                        if (targetForm) targetForm.style.display = 'block';
                    });
                }
            }

            setupRepoTypeSelect('add-repo-type-select', 'add');
            setupRepoTypeSelect('edit-repo-type-select', 'edit');

            document.getElementById('add-repo-modal')?.addEventListener('submit', async function(e) {
                e.preventDefault();
                const form = e.target;
                const submitBtn = form.querySelector('button[type="submit"]');
                const originalBtnText = submitBtn.innerHTML;

                try {
                    submitBtn.disabled = true;
                    submitBtn.innerHTML = '<span class="spinner-border spinner-border-sm" role="status" aria-hidden="true"></span> Connecting...';

                    const formData = new FormData(form);

                    const visibleForm = form.querySelector('.repo-form[style*="display: block"]');
                    if (visibleForm) {
                        const accessTokenInput = visibleForm.querySelector('input[name="settings[0].AccessToken"]');
                        if (accessTokenInput) {
                            formData.set('settings[0].AccessToken', accessTokenInput.value);
                        }
                    }

                    const response = await fetch(form.action, {
                        method: 'POST',
                        body: formData,
                        headers: {
                            'RequestVerificationToken': document.querySelector('input[name="__RequestVerificationToken"]').value
                        }
                    });

                    const result = await response.json();

                    if (result.success) {
                        showCustomToast('success', result.message);
                        setTimeout(() => location.reload(), 1500);
                    } else {
                        showCustomToast('danger', result.message);
                    }
                } catch (error) {
                    console.error('Error:', error);
                    showCustomToast('danger', 'An error occurred while adding repository');
                } finally {
                    submitBtn.disabled = false;
                    submitBtn.innerHTML = originalBtnText;
                }
            });

            document.querySelectorAll('[data-bs-target="#edit-repo-modal"]').forEach(btn => {
                btn.addEventListener('click', async function(e) {
                    e.preventDefault();
                    const repoId = this.getAttribute('data-repo-id');
                    const editModal = document.getElementById('edit-repo-modal');

                    if (editModal._modal) {
                        editModal._modal.hide();
                        const existingBackdrop = document.querySelector('.modal-backdrop');
                        if (existingBackdrop) existingBackdrop.remove();
                    }

                    try {
                        const response = await fetch(`/SiteSettings/GetRepoById?id=${repoId}`);
                        if (!response.ok) throw new Error('Failed to load repository');
                        const repo = await response.json();

                        document.getElementById('edit-repo-id').value = repo.id;
                        document.getElementById('edit-repo-display-name').value = repo.displayName;
                        document.getElementById('edit-repo-type-select').value = repo.repoType;

                        if (repo.repoType === 'GitHub') {
                            document.getElementById('edit-github-token').value = repo.accessToken || '';
                        } else if (repo.repoType === 'Bitbucket') {
                            document.getElementById('edit-bitbucket-token').value = repo.accessToken || '';
                        } else if (repo.repoType === 'GitLab') {
                            document.getElementById('edit-gitlab-token').value = repo.accessToken || '';
                        } else if (repo.repoType === 'Azure') {
                            document.getElementById('edit-azure-token').value = repo.accessToken || '';
                            document.getElementById('edit-azure-username').value = repo.username || '';
                            document.getElementById('edit-azure-domain').value = repo.domainName || '';
                            document.getElementById('edit-azure-collection').value = repo.collectionName || '';
                            document.getElementById('edit-azure-project').value = repo.projectName || '';
                        }

                        document.getElementById('edit-repo-type-select').dispatchEvent(new Event('change'));

                        editModal._modal = new bootstrap.Modal(editModal);
                        editModal._modal.show();

                    } catch (error) {
                        console.error('Error:', error);
                        showCustomToast('danger', 'Error loading repository: ' + error.message);
                    }
                });
            });
            document.getElementById('edit-repo-modal').addEventListener('hidden.bs.modal', function() {
                const backdrops = document.querySelectorAll('.modal-backdrop');
                backdrops.forEach(backdrop => backdrop.remove());
            });

            document.getElementById('edit-repo-form')?.addEventListener('submit', async function(e) {
                e.preventDefault();
                const form = e.target;
                const submitBtn = form.querySelector('button[type="submit"]');
                const originalBtnText = submitBtn.innerHTML;

                try {
                    submitBtn.disabled = true;
                    submitBtn.innerHTML = '<span class="spinner-border spinner-border-sm" role="status" aria-hidden="true"></span> Updating...';

                    const formData = new FormData(form);

                    const visibleForm = form.querySelector('.repo-form[style*="display: block"]');
                    if (visibleForm) {
                        const accessTokenInput = visibleForm.querySelector('input[name="settings[0].AccessToken"]');
                        if (accessTokenInput) {
                            formData.set('settings[0].AccessToken', accessTokenInput.value);
                        }
                    }
                    const response = await fetch(form.action, {
                        method: 'POST',
                        body: formData,
                        headers: {
                            'RequestVerificationToken': document.querySelector('input[name="__RequestVerificationToken"]').value
                        }
                    });

                    const result = await response.json();

                    if (result.success) {
                        showCustomToast('success', result.message);
                        setTimeout(() => location.reload(), 1500);
                    } else {
                        showCustomToast('danger', result.message);
                    }
                } catch (error) {
                    console.error('Error:', error);
                    showCustomToast('danger', 'An error occurred while updating repository');
                } finally {
                    submitBtn.disabled = false;
                    submitBtn.innerHTML = originalBtnText;
                }
            });

            document.querySelectorAll('[data-bs-target="#delete-repo-modal"]').forEach(btn => {
                btn.addEventListener('click', function(e) {
                    e.preventDefault();
                    document.getElementById('delete-repo-id').value = this.getAttribute('data-repo-id');
                });
            });

            document.getElementById('delete-repo-form')?.addEventListener('submit', async function(e) {
                e.preventDefault();
                const form = e.target;
                const submitBtn = form.querySelector('button[type="submit"]');
                const originalBtnText = submitBtn.innerHTML;
    
                try {
                    submitBtn.disabled = true;
                    submitBtn.innerHTML = '<span class="spinner-border spinner-border-sm" role="status" aria-hidden="true"></span> Deleting...';
        
                    const repoId = document.getElementById('delete-repo-id').value;
                    const response = await fetch(`/SiteSettings/DeleteRepoSettings?id=${repoId}`, {
                        method: 'DELETE',
                        headers: {
                            'RequestVerificationToken': document.querySelector('input[name="__RequestVerificationToken"]').value
                        }
                    });

                    const result = await response.json();
        
                    if (result.success) {
                        showCustomToast('success',result.message);
                        setTimeout(() => location.reload(), 1500);
                    } else {
                        showCustomToast('danger',result.message);
                    }
                } catch (error) {
                    console.error('Error:', error);
                    showCustomToast('danger','An error occurred while deleting repository');
                } finally {
                    submitBtn.disabled = false;
                    submitBtn.innerHTML = originalBtnText;
                }
            });

            document.querySelector('form[asp-action="SaveProjectFolder"]')?.addEventListener('submit', async function(e) {
                e.preventDefault();
                const form = e.target;
                const submitBtn = form.querySelector('button[type="submit"]');
                const originalBtnText = submitBtn.innerHTML;

                try {
                    submitBtn.disabled = true;
                    submitBtn.innerHTML = '<span class="spinner-border spinner-border-sm" role="status" aria-hidden="true"></span> Saving...';

                    const formData = new FormData(form);
                    const response = await fetch('/SiteSettings/SaveProjectFolder', {
                        method: 'POST',
                        body: formData,
                        headers: {
                            'RequestVerificationToken': document.querySelector('input[name="__RequestVerificationToken"]').value
                        }
                    });

                    if (response.ok) {
                        showCustomToast('success','Project directory saved successfully');
                        location.reload();
                    } else {
                        const error = await response.text();
                        showCustomToast('danger',error || 'Failed to save project directory');
                    }
                } catch (error) {
                    console.error('Error:', error);
                    showCustomToast('danger','An error occurred while saving project directory');
                } finally {
                    submitBtn.disabled = false;
                    submitBtn.innerHTML = originalBtnText;
                }
            });

            document.querySelectorAll('input[name="addToolType"]').forEach(radio => {
                radio.addEventListener('change', function() {
                    const selectedType = this.value.toLowerCase();
                    document.querySelectorAll('#modal-add-cicd .cicd-provider-fields').forEach(field => {
                        field.classList.add('d-none');
                    });
                    const targetField = document.getElementById(`${selectedType}-fields`);
                    if (targetField) targetField.classList.remove('d-none');
                });
            });

            function handleProviderChange(modalId, prefix = '') {
                const modalElement = document.getElementById(modalId);
                if (!modalElement) return;

                modalElement.addEventListener('change', function(e) {
                    if (e.target.name === 'settings[0].ToolType') {
                        const selectedType = e.target.value.toLowerCase();
                        modalElement.querySelectorAll('.cicd-provider-fields').forEach(field => {
                            field.classList.add('d-none');
                        });
                        const targetField = modalElement.querySelector(`#${prefix}${selectedType}-fields`);
                        if (targetField) targetField.classList.remove('d-none');
                    }
                });

                modalElement.addEventListener('show.bs.modal', function() {
                    const selectedRadio = modalElement.querySelector('input[name="settings[0].ToolType"]:checked');
                    if (selectedRadio) {
                        const selectedType = selectedRadio.value.toLowerCase();
                        modalElement.querySelectorAll('.cicd-provider-fields').forEach(field => {
                            field.classList.add('d-none');
                        });
                        const targetField = modalElement.querySelector(`#${prefix}${selectedType}-fields`);
                        if (targetField) targetField.classList.remove('d-none');
                    }
                });
            }

            handleProviderChange('modal-add-cicd');
            handleProviderChange('edit-cicd-modal', 'edit-');

            document.getElementById('cicd-form')?.addEventListener('submit', async function(e) {
                e.preventDefault();
                const form = e.target;
                const submitBtn = form.querySelector('button[type="submit"]');
                const originalBtnText = submitBtn.innerHTML;

                try {
                    submitBtn.disabled = true;
                    submitBtn.innerHTML = `
                        <span class="spinner-border spinner-border-sm" role="status" aria-hidden="true"></span>
                        Saving...
                    `;

                    const formData = new FormData(form);
                    const response = await fetch(form.action, {
                        method: 'POST',
                        body: formData,
                        headers: {
                            'RequestVerificationToken': document.querySelector('input[name="__RequestVerificationToken"]').value
                        }
                    });

                    const result = await response.json();

                    if (result.success) {
                        showCustomToast('success','Configuration saved successfully');
                        setTimeout(() => location.reload(), 1500);
                    } else {
                        showCustomToast('danger',result.message || 'Failed to save configuration');
                    }
                } catch (error) {
                    console.error('Error:', error);
                    showCustomToast('danger','An error occurred while saving');
                } finally {
                    submitBtn.disabled = false;
                    submitBtn.innerHTML = originalBtnText;
                }
            });

            document.querySelectorAll('[data-bs-target="#edit-cicd-modal"]').forEach(btn => {
                btn.addEventListener('click', async function(e) {
                    e.preventDefault();
                    const cicdId = this.getAttribute('data-setting-id');

                    try {
                        const response = await fetch(`/SiteSettings/GetCiCdSettingsById?id=${cicdId}`);
                        if (!response.ok) throw new Error('Failed to load CI/CD settings');

                        const cicd = await response.json();
                        console.log(cicd);

                        document.getElementById('edit-cicd-id').value = cicd.id;
                        document.getElementById('edit-cicd-name').value = cicd.name;
                        document.getElementById('edit-cicd-apiurl').value = cicd.apiUrl;
                        document.getElementById('edit-cicd-accesstoken').value = cicd.accessToken;

                        const providerRadios = document.querySelectorAll('#edit-cicd-modal input[name="settings[0].ToolType"]');
                        providerRadios.forEach(radio => {
                            radio.checked = (radio.value === cicd.toolType);
                        });

                        providerRadios.forEach(radio => {
                            if (radio.checked) {
                                radio.dispatchEvent(new Event('change'));
                            }
                        });

                        if (cicd.toolTypeString === 'Azure') {
                            document.getElementById('edit-cicd-organization').value = cicd.organization || '';
                            document.getElementById('edit-cicd-project').value = cicd.project || '';
                            document.getElementById('edit-cicd-collectionname').value = cicd.collectionName || '';
                        } else if (cicd.toolTypeString === 'Jenkins') {
                            document.getElementById('edit-cicd-jobname').value = cicd.jobName || '';
                            document.getElementById('edit-cicd-jenkinsusername').value = cicd.jenkinsUsername || '';
                            document.getElementById('edit-cicd-crumb').value = cicd.crumb || '';
                        } else if (cicd.toolTypeString === 'GitLab') {
                            document.getElementById('edit-cicd-groupid').value = cicd.groupId || '';
                            document.getElementById('edit-cicd-projectid').value = cicd.projectId || '';
                        }

                        new bootstrap.Modal(document.getElementById('edit-cicd-modal')).show();
                    } catch (error) {
                        console.error('Error:', error);
                        showCustomToast('danger', 'Error loading CI/CD settings: ' + error.message);
                    }
                });
            });

            document.getElementById('edit-cicd-modal').addEventListener('hidden.bs.modal', function() {
                const backdrops = document.querySelectorAll('.modal-backdrop');
                backdrops.forEach(backdrop => backdrop.remove());
            });

            document.getElementById('edit-cicd-form')?.addEventListener('submit', async function(e) {
                e.preventDefault();
                const form = e.target;
                const submitBtn = form.querySelector('button[type="submit"]');
                const originalBtnText = submitBtn.innerHTML;

                try {
                    submitBtn.disabled = true;
                    submitBtn.innerHTML = '<span class="spinner-border spinner-border-sm" role="status" aria-hidden="true"></span> Updating...';

                    const formData = new FormData(form);
                    const response = await fetch(form.action, {
                        method: 'POST',
                        body: formData,
                        headers: {
                            'RequestVerificationToken': document.querySelector('input[name="__RequestVerificationToken"]').value
                        }
                    });

                    const result = await response.json();

                    if (result.success) {
                        showCustomToast('success','CI/CD settings updated successfully');
                        setTimeout(() => location.reload(), 1500);
                    } else {
                        showCustomToast('danger',result.message || 'Failed to update CI/CD settings');
                    }
                } catch (error) {
                    console.error('Error:', error);
                    showCustomToast('danger','An error occurred while updating CI/CD settings');
                } finally {
                    submitBtn.disabled = false;
                    submitBtn.innerHTML = originalBtnText;
                }
            });

            document.querySelectorAll('[data-bs-target="#delete-cicd-modal"]').forEach(btn => {
                btn.addEventListener('click', function(e) {
                    e.preventDefault();
                    document.getElementById('delete-cicd-id').value = this.getAttribute('data-setting-id');
                });
            });

            document.getElementById('delete-cicd-form')?.addEventListener('submit', async function(e) {
                e.preventDefault();
                const form = e.target;
                const submitBtn = form.querySelector('button[type="submit"]');
                const originalBtnText = submitBtn.innerHTML;

                try {
                    submitBtn.disabled = true;
                    submitBtn.innerHTML = '<span class="spinner-border spinner-border-sm" role="status" aria-hidden="true"></span> Deleting...';

                    const cicdId = document.getElementById('delete-cicd-id').value;
                    const response = await fetch(`/SiteSettings/DeleteCiCdSettings?id=${cicdId}`, {
                        method: 'DELETE',
                        headers: {
                            'RequestVerificationToken': document.querySelector('input[name="__RequestVerificationToken"]').value,
                            'Content-Type': 'application/json'
                        }
                    });

                    if (!response.ok) {
                        throw new Error('Failed to delete CI/CD settings');
                    }

                    const result = await response.json();
        
                    if (result.success) {
                        showCustomToast('success', result.message);
                        setTimeout(() => location.reload(), 1500);
                    } else {
                        showCustomToast('danger', result.message || 'Failed to delete CI/CD settings');
                    }
                } catch (error) {
                    console.error('Error:', error);
                    showCustomToast('danger', 'An error occurred while deleting CI/CD settings');
                } finally {
                    submitBtn.disabled = false;
                    submitBtn.innerHTML = originalBtnText;
                }
            });

            document.getElementById('mail-provider-select')?.addEventListener('change', function() {
                const selectedProvider = this.value.toLowerCase();
                document.querySelectorAll('.mail-provider-fields').forEach(field => {
                    field.style.display = 'none';
                });
                const targetField = document.getElementById(`${selectedProvider}-fields`);
                if (targetField) targetField.style.display = 'block';
            });

            document.getElementById('edit-mail-provider-select')?.addEventListener('change', function() {
                const selectedProvider = this.value.toLowerCase();
                document.querySelectorAll('#edit-mail-modal .mail-provider-fields').forEach(field => {
                    field.style.display = 'none';
                });
                const targetField = document.getElementById(`edit-${selectedProvider}-fields`);
                if (targetField) targetField.style.display = 'block';
            });

            document.getElementById('toggleSmtpPassword')?.addEventListener('click', function() {
                togglePasswordVisibility('input[name="SmtpPassword"]', this);
            });

            document.getElementById('toggleSendGridKey')?.addEventListener('click', function() {
                togglePasswordVisibility('input[name="SendGridApiKey"]', this);
            });

            document.getElementById('toggleAzureSecret')?.addEventListener('click', function() {
                togglePasswordVisibility('input[name="AzureClientSecret"]', this);
            });

            document.getElementById('toggleEditSmtpPassword')?.addEventListener('click', function() {
                togglePasswordVisibility('#edit-smtp-password', this);
            });

            document.getElementById('toggleEditSendGridKey')?.addEventListener('click', function() {
                togglePasswordVisibility('#edit-sendgrid-key', this);
            });

            document.getElementById('toggleEditAzureSecret')?.addEventListener('click', function() {
                togglePasswordVisibility('#edit-azure-secret', this);
            });

            function togglePasswordVisibility(selector, button) {
                const input = document.querySelector(selector);
                if (input.type === 'password') {
                    input.type = 'text';
                    button.innerHTML = `
                        <svg xmlns="http://www.w3.org/2000/svg" class="icon" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
                            <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
                            <path d="M13.875 18.825a10.05 10.05 0 0 1 .875 -.825a10.05 10.05 0 0 0 3.574 -7.31l.26 -.16"></path>
                            <path d="M10 12a2 2 0 1 0 4 0a2 2 0 0 0 -4 0"></path>
                            <path d="M12 18c-3.6 0 -6.6 -2 -9 -6c2.4 -4 5.4 -6 9 -6c1.425 0 2.774 .25 4 .704"></path>
                            <path d="M3 3l18 18"></path>
                        </svg>
                    `;
                } else {
                    input.type = 'password';
                    button.innerHTML = `
                        <svg xmlns="http://www.w3.org/2000/svg" class="icon" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
                            <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
                            <path d="M10 12a2 2 0 1 0 4 0a2 2 0 0 0 -4 0"></path>
                            <path d="M21 12c-2.4 4 -5.4 6 -9 6c-3.6 0 -6.6 -2 -9 -6c2.4 -4 5.4 -6 9 -6c3.6 0 6.6 2 9 6"></path>
                        </svg>
                    `;
                }
            }

            document.querySelectorAll('[data-bs-target="#edit-mail-modal"]').forEach(btn => {
                btn.addEventListener('click', async function(e) {
                    e.preventDefault();

                    document.querySelectorAll('.modal-backdrop').forEach(el => el.remove());

                    const mailId = this.getAttribute('data-mail-id');
                    const modal = new bootstrap.Modal(document.getElementById('edit-mail-modal'));

                    try {
                        const response = await fetch(`/SiteSettings/GetMailSettingsById?id=${mailId}`);
                        if (!response.ok) throw new Error('Failed to load mail settings');

                        const mailSettings = await response.json();

                        document.getElementById('edit-mail-id').value = mailSettings.id;
                        document.getElementById('edit-mail-name').value = mailSettings.name;
                        document.getElementById('edit-mail-provider-select').value = mailSettings.provider;

                        if (mailSettings.provider === 'SMTP') {
                            document.getElementById('edit-smtp-host').value = mailSettings.smtpHost || '';
                            document.getElementById('edit-smtp-port').value = mailSettings.smtpPort || '';
                            document.getElementById('edit-smtp-username').value = mailSettings.smtpUsername || '';
                            document.getElementById('edit-smtp-password').value = mailSettings.smtpPassword || '';
                        } else if (mailSettings.provider === 'SendGrid') {
                            document.getElementById('edit-sendgrid-key').value = mailSettings.sendGridApiKey || '';
                        } else if (mailSettings.provider === 'Azure') {
                            document.getElementById('edit-azure-tenant').value = mailSettings.azureTenantId || '';
                            document.getElementById('edit-azure-client').value = mailSettings.azureClientId || '';
                            document.getElementById('edit-azure-secret').value = mailSettings.azureClientSecret || '';
                        }

                        document.getElementById('edit-mail-provider-select').dispatchEvent(new Event('change'));

                        modal.show();

                        document.getElementById('edit-mail-modal').addEventListener('hidden.bs.modal', function() {
                            document.querySelectorAll('.modal-backdrop').forEach(el => el.remove());
                        });
                    } catch (error) {
                        console.error('Error:', error);
                        showCustomToast('danger', 'Error loading mail settings: ' + error.message);
                    }
                });
            });

            document.querySelectorAll('[data-bs-target="#delete-mail-modal"]').forEach(btn => {
                btn.addEventListener('click', function(e) {
                    e.preventDefault();
                    const mailId = this.getAttribute('data-mail-id');
                    document.getElementById('delete-mail-id').value = mailId;
                });
            });

            document.getElementById('add-mail-form')?.addEventListener('submit', async function(e) {
                e.preventDefault();
                const form = e.target;
                const submitBtn = form.querySelector('button[type="submit"]');
                const originalBtnText = submitBtn.innerHTML;

                try {
                    submitBtn.disabled = true;
                    submitBtn.innerHTML = '<span class="spinner-border spinner-border-sm" role="status" aria-hidden="true"></span> Saving...';

                    const formData = new FormData(form);
                    console.log(formData);
                    const response = await fetch(form.action, {
                        method: 'POST',
                        body: formData,
                        headers: {
                            'RequestVerificationToken': document.querySelector('input[name="__RequestVerificationToken"]').value
                        }
                    });

                    const result = await response.json();

                    if (result.success) {
                        showCustomToast('success', 'Mail settings saved successfully');
                        setTimeout(() => location.reload(), 1500);
                    } else {
                        showCustomToast('danger', result.message || 'Failed to save mail settings');
                    }
                } catch (error) {
                    console.error('Error:', error);
                    showCustomToast('danger', 'An error occurred while saving mail settings');
                } finally {
                    submitBtn.disabled = false;
                    submitBtn.innerHTML = originalBtnText;
                }
            });

            document.getElementById('edit-mail-form')?.addEventListener('submit', async function(e) {
                e.preventDefault();
                const form = e.target;
                const submitBtn = form.querySelector('button[type="submit"]');
                const originalBtnText = submitBtn.innerHTML;

                try {
                    submitBtn.disabled = true;
                    submitBtn.innerHTML = '<span class="spinner-border spinner-border-sm" role="status" aria-hidden="true"></span> Updating...';

                    const formData = new FormData(form);
                    const response = await fetch(form.action, {
                        method: 'POST',
                        body: formData,
                        headers: {
                            'RequestVerificationToken': document.querySelector('input[name="__RequestVerificationToken"]').value
                        }
                    });

                    const result = await response.json();

                    if (result.success) {
                        showCustomToast('success', 'Mail settings updated successfully');
                        setTimeout(() => location.reload(), 1500);
                    } else {
                        showCustomToast('danger', result.message || 'Failed to update mail settings');
                    }
                } catch (error) {
                    console.error('Error:', error);
                    showCustomToast('danger', 'An error occurred while updating mail settings');
                } finally {
                    submitBtn.disabled = false;
                    submitBtn.innerHTML = originalBtnText;
                }
            });

            document.getElementById('delete-mail-form')?.addEventListener('submit', async function(e) {
                e.preventDefault();
                const form = e.target;
                const submitBtn = form.querySelector('button[type="submit"]');
                const originalBtnText = submitBtn.innerHTML;

                try {
                    submitBtn.disabled = true;
                    submitBtn.innerHTML = '<span class="spinner-border spinner-border-sm" role="status" aria-hidden="true"></span> Deleting...';

                    const deleteId = document.getElementById('delete-mail-id').value;
                    const response = await fetch(`/SiteSettings/DeleteMailSettings?id=${deleteId}`, {
                        method: 'DELETE',
                        headers: {
                            'RequestVerificationToken': document.querySelector('input[name="__RequestVerificationToken"]').value,
                            'Content-Type': 'application/json'
                        }
                    });

                    const result = await response.json();

                    if (result.success) {
                        showCustomToast('success', result.message);
                        setTimeout(() => location.reload(), 1500);
                    } else {
                        showCustomToast('danger', result.message || 'Failed to delete mail settings');
                    }
                } catch (error) {
                    console.error('Error:', error);
                    showCustomToast('danger', 'An error occurred while deleting mail settings');
                } finally {
                    submitBtn.disabled = false;
                    submitBtn.innerHTML = originalBtnText;
                }
            });
        });
    </script>
}